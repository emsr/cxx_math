// { dg-options "-D__STDCPP_WANT_MATH_SPEC_FUNCS__" }
//
// Copyright (C) 2016 Free Software Foundation, Inc.
//
// This file is part of the GNU ISO C++ Library.  This library is free
// software; you can redistribute it and/or modify it under the
// terms of the GNU General Public License as published by the
// Free Software Foundation; either version 3, or (at your option)
// any later version.
//
// This library is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this library; see the file COPYING3.  If not see
// <http://www.gnu.org/licenses/>.

//  jacobi_dn
//  Compare against values generated by the GNU Scientific Library.
//  The GSL can be found on the web: http://www.gnu.org/software/gsl/
#include <limits>
#include <cmath>
#if defined(__TEST_DEBUG)
#  include <iostream>
#  define VERIFY(A) \
  if (!(A)) \
    { \
      std::cout << "line " << __LINE__ \
	<< "  max_abs_frac = " << max_abs_frac \
	<< std::endl; \
    }
#else
#  include <testsuite_hooks.h>
#endif
#include <specfun_testcase.h>


// Test data for u=-1.0000000000000000.
// max(|f - f_GSL|): 0.029982128801585795
// max(|f - f_GSL| / |f_GSL|): 0.036267786293136484
const testcase_jacobi_dn<double>
data001[21] =
{
  { 0.64805427366388546, -1.0000000000000000, -1.0000000000000000 },
  { 0.71426248915701351, -1.0000000000000000, -0.90000000000000002 },
  { 0.77386932199584635, -1.0000000000000000, -0.80000000000000004 },
  { 0.82668758879446080, -1.0000000000000000, -0.69999999999999996 },
  { 0.87258917138824266, -1.0000000000000000, -0.59999999999999998 },
  { 0.91149200566913202, -1.0000000000000000, -0.50000000000000000 },
  { 0.94334813627860858, -1.0000000000000000, -0.40000000000000002 },
  { 0.96813320375474532, -1.0000000000000000, -0.30000000000000004 },
  { 0.98583761608732368, -1.0000000000000000, -0.19999999999999996 },
  { 0.99645956721562878, -1.0000000000000000, -0.099999999999999978 },
  { 1.0000000000000000, -1.0000000000000000, 0.0000000000000000 },
  { 0.99645956721562878, -1.0000000000000000, 0.10000000000000009 },
  { 0.98583761608732368, -1.0000000000000000, 0.19999999999999996 },
  { 0.96813320375474532, -1.0000000000000000, 0.30000000000000004 },
  { 0.94334813627860858, -1.0000000000000000, 0.39999999999999991 },
  { 0.91149200566913202, -1.0000000000000000, 0.50000000000000000 },
  { 0.87258917138824266, -1.0000000000000000, 0.60000000000000009 },
  { 0.82668758879446080, -1.0000000000000000, 0.69999999999999996 },
  { 0.77386932199584635, -1.0000000000000000, 0.80000000000000004 },
  { 0.71426248915701362, -1.0000000000000000, 0.89999999999999991 },
  { 0.64805427366388546, -1.0000000000000000, 1.0000000000000000 },
};
const double toler001 = 0.050000000000000003;

// Test data for u=-0.90000000000000036.
// max(|f - f_GSL|): 0.017221337601910025
// max(|f - f_GSL| / |f_GSL|): 0.023599848847669878
const testcase_jacobi_dn<double>
data002[21] =
{
  { 0.69779464110033207, -0.90000000000000036, -1.0000000000000000 },
  { 0.75433996484295673, -0.90000000000000036, -0.90000000000000002 },
  { 0.80533163253704532, -0.90000000000000036, -0.80000000000000004 },
  { 0.85060554010040512, -0.90000000000000036, -0.69999999999999996 },
  { 0.89003472239039971, -0.90000000000000036, -0.59999999999999998 },
  { 0.92352317760339009, -0.90000000000000036, -0.50000000000000000 },
  { 0.95100015407466965, -0.90000000000000036, -0.40000000000000002 },
  { 0.97241507337109867, -0.90000000000000036, -0.30000000000000004 },
  { 0.98773322313268241, -0.90000000000000036, -0.19999999999999996 },
  { 0.99693231826899864, -0.90000000000000036, -0.099999999999999978 },
  { 1.0000000000000000, -0.90000000000000036, 0.0000000000000000 },
  { 0.99693231826899864, -0.90000000000000036, 0.10000000000000009 },
  { 0.98773322313268241, -0.90000000000000036, 0.19999999999999996 },
  { 0.97241507337109867, -0.90000000000000036, 0.30000000000000004 },
  { 0.95100015407466965, -0.90000000000000036, 0.39999999999999991 },
  { 0.92352317760339009, -0.90000000000000036, 0.50000000000000000 },
  { 0.89003472239039971, -0.90000000000000036, 0.60000000000000009 },
  { 0.85060554010040512, -0.90000000000000036, 0.69999999999999996 },
  { 0.80533163253704532, -0.90000000000000036, 0.80000000000000004 },
  { 0.75433996484295696, -0.90000000000000036, 0.89999999999999991 },
  { 0.69779464110033207, -0.90000000000000036, 1.0000000000000000 },
};
const double toler002 = 0.050000000000000003;

// Test data for u=-0.79999999999999982.
// max(|f - f_GSL|): 0.026169403758427134
// max(|f - f_GSL| / |f_GSL|): 0.034999875110481790
const testcase_jacobi_dn<double>
data003[21] =
{
  { 0.74769991823741966, -0.79999999999999982, -1.0000000000000000 },
  { 0.79479625944854992, -0.79999999999999982, -0.90000000000000002 },
  { 0.83729114994772580, -0.79999999999999982, -0.80000000000000004 },
  { 0.87505260553215503, -0.79999999999999982, -0.69999999999999996 },
  { 0.90797172770006129, -0.79999999999999982, -0.59999999999999998 },
  { 0.93596010327598267, -0.79999999999999982, -0.50000000000000000 },
  { 0.95894739155328479, -0.79999999999999982, -0.40000000000000002 },
  { 0.97687917024940485, -0.79999999999999982, -0.30000000000000004 },
  { 0.98971509848823991, -0.79999999999999982, -0.19999999999999996 },
  { 0.99742744271173889, -0.79999999999999982, -0.099999999999999978 },
  { 1.0000000000000000, -0.79999999999999982, 0.0000000000000000 },
  { 0.99742744271173889, -0.79999999999999982, 0.10000000000000009 },
  { 0.98971509848823991, -0.79999999999999982, 0.19999999999999996 },
  { 0.97687917024940485, -0.79999999999999982, 0.30000000000000004 },
  { 0.95894739155328479, -0.79999999999999982, 0.39999999999999991 },
  { 0.93596010327598267, -0.79999999999999982, 0.50000000000000000 },
  { 0.90797172770006118, -0.79999999999999982, 0.60000000000000009 },
  { 0.87505260553215503, -0.79999999999999982, 0.69999999999999996 },
  { 0.83729114994772580, -0.79999999999999982, 0.80000000000000004 },
  { 0.79479625944855004, -0.79999999999999982, 0.89999999999999991 },
  { 0.74769991823741966, -0.79999999999999982, 1.0000000000000000 },
};
const double toler003 = 0.050000000000000003;

// Test data for u=-0.70000000000000018.
// max(|f - f_GSL|): 0.029982128801585906
// max(|f - f_GSL| / |f_GSL|): 0.037632638794585442
const testcase_jacobi_dn<double>
data004[21] =
{
  { 0.79670545999287490, -0.70000000000000018, -1.0000000000000000 },
  { 0.83465754721119778, -0.70000000000000018, -0.90000000000000002 },
  { 0.86889039930773859, -0.70000000000000018, -0.80000000000000004 },
  { 0.89930737730509924, -0.70000000000000018, -0.69999999999999996 },
  { 0.92582589832868323, -0.70000000000000018, -0.59999999999999998 },
  { 0.94837651273058077, -0.70000000000000018, -0.50000000000000000 },
  { 0.96690204766780252, -0.70000000000000018, -0.40000000000000002 },
  { 0.98135684150561997, -0.70000000000000018, -0.30000000000000004 },
  { 0.99170608961762485, -0.70000000000000018, -0.19999999999999996 },
  { 0.99792531833474940, -0.70000000000000018, -0.099999999999999978 },
  { 1.0000000000000000, -0.70000000000000018, 0.0000000000000000 },
  { 0.99792531833474940, -0.70000000000000018, 0.10000000000000009 },
  { 0.99170608961762485, -0.70000000000000018, 0.19999999999999996 },
  { 0.98135684150561997, -0.70000000000000018, 0.30000000000000004 },
  { 0.96690204766780241, -0.70000000000000018, 0.39999999999999991 },
  { 0.94837651273058077, -0.70000000000000018, 0.50000000000000000 },
  { 0.92582589832868334, -0.70000000000000018, 0.60000000000000009 },
  { 0.89930737730509924, -0.70000000000000018, 0.69999999999999996 },
  { 0.86889039930773859, -0.70000000000000018, 0.80000000000000004 },
  { 0.83465754721119778, -0.70000000000000018, 0.89999999999999991 },
  { 0.79670545999287490, -0.70000000000000018, 1.0000000000000000 },
};
const double toler004 = 0.050000000000000003;

// Test data for u=-0.59999999999999964.
// max(|f - f_GSL|): 0.029038483766435919
// max(|f - f_GSL| / |f_GSL|): 0.034424112495602496
const testcase_jacobi_dn<double>
data005[21] =
{
  { 0.84355068762180685, -0.59999999999999964, -1.0000000000000000 },
  { 0.87281338478848958, -0.59999999999999964, -0.90000000000000002 },
  { 0.89918189933285819, -0.59999999999999964, -0.80000000000000004 },
  { 0.92259290662864846, -0.59999999999999964, -0.69999999999999996 },
  { 0.94299126446415793, -0.59999999999999964, -0.59999999999999998 },
  { 0.96032976181267005, -0.59999999999999964, -0.50000000000000000 },
  { 0.97456888555904098, -0.59999999999999964, -0.40000000000000002 },
  { 0.98567661175307120, -0.59999999999999964, -0.30000000000000004 },
  { 0.99362822702227538, -0.59999999999999964, -0.19999999999999996 },
  { 0.99840618479792842, -0.59999999999999964, -0.099999999999999978 },
  { 1.0000000000000000, -0.59999999999999964, 0.0000000000000000 },
  { 0.99840618479792842, -0.59999999999999964, 0.10000000000000009 },
  { 0.99362822702227538, -0.59999999999999964, 0.19999999999999996 },
  { 0.98567661175307120, -0.59999999999999964, 0.30000000000000004 },
  { 0.97456888555904120, -0.59999999999999964, 0.39999999999999991 },
  { 0.96032976181267005, -0.59999999999999964, 0.50000000000000000 },
  { 0.94299126446415804, -0.59999999999999964, 0.60000000000000009 },
  { 0.92259290662864846, -0.59999999999999964, 0.69999999999999996 },
  { 0.89918189933285819, -0.59999999999999964, 0.80000000000000004 },
  { 0.87281338478848969, -0.59999999999999964, 0.89999999999999991 },
  { 0.84355068762180685, -0.59999999999999964, 1.0000000000000000 },
};
const double toler005 = 0.050000000000000003;

// Test data for u=-0.50000000000000000.
// max(|f - f_GSL|): 0.024673121699057998
// max(|f - f_GSL| / |f_GSL|): 0.027822052670554768
const testcase_jacobi_dn<double>
data006[21] =
{
  { 0.88681888397007402, -0.50000000000000000, -1.0000000000000000 },
  { 0.90805383458107469, -0.50000000000000000, -0.90000000000000002 },
  { 0.92716103522748838, -0.50000000000000000, -0.80000000000000004 },
  { 0.94410443489592599, -0.50000000000000000, -0.69999999999999996 },
  { 0.95885234505946271, -0.50000000000000000, -0.59999999999999998 },
  { 0.97137739883817886, -0.50000000000000000, -0.50000000000000000 },
  { 0.98165651255837094, -0.50000000000000000, -0.40000000000000002 },
  { 0.98967085099120156, -0.50000000000000000, -0.30000000000000004 },
  { 0.99540579737384005, -0.50000000000000000, -0.19999999999999996 },
  { 0.99885092912858620, -0.50000000000000000, -0.099999999999999978 },
  { 1.0000000000000000, -0.50000000000000000, 0.0000000000000000 },
  { 0.99885092912858620, -0.50000000000000000, 0.10000000000000009 },
  { 0.99540579737384005, -0.50000000000000000, 0.19999999999999996 },
  { 0.98967085099120156, -0.50000000000000000, 0.30000000000000004 },
  { 0.98165651255837105, -0.50000000000000000, 0.39999999999999991 },
  { 0.97137739883817886, -0.50000000000000000, 0.50000000000000000 },
  { 0.95885234505946249, -0.50000000000000000, 0.60000000000000009 },
  { 0.94410443489592599, -0.50000000000000000, 0.69999999999999996 },
  { 0.92716103522748838, -0.50000000000000000, 0.80000000000000004 },
  { 0.90805383458107469, -0.50000000000000000, 0.89999999999999991 },
  { 0.88681888397007402, -0.50000000000000000, 1.0000000000000000 },
};
const double toler006 = 0.050000000000000003;

// Test data for u=-0.40000000000000036.
// max(|f - f_GSL|): 0.018340684372853633
// max(|f - f_GSL| / |f_GSL|): 0.019827607156101362
const testcase_jacobi_dn<double>
data007[21] =
{
  { 0.92500745190575495, -0.40000000000000036, -1.0000000000000000 },
  { 0.93912818070234527, -0.40000000000000036, -0.90000000000000002 },
  { 0.95181335823831092, -0.40000000000000036, -0.80000000000000004 },
  { 0.96304603930234189, -0.40000000000000036, -0.69999999999999996 },
  { 0.97281127049661942, -0.40000000000000036, -0.59999999999999998 },
  { 0.98109609144787457, -0.40000000000000036, -0.50000000000000000 },
  { 0.98788953548762481, -0.40000000000000036, -0.40000000000000002 },
  { 0.99318262995704742, -0.40000000000000036, -0.30000000000000004 },
  { 0.99696839627021794, -0.40000000000000036, -0.19999999999999996 },
  { 0.99924184984660724, -0.40000000000000036, -0.099999999999999978 },
  { 1.0000000000000000, -0.40000000000000036, 0.0000000000000000 },
  { 0.99924184984660724, -0.40000000000000036, 0.10000000000000009 },
  { 0.99696839627021794, -0.40000000000000036, 0.19999999999999996 },
  { 0.99318262995704742, -0.40000000000000036, 0.30000000000000004 },
  { 0.98788953548762470, -0.40000000000000036, 0.39999999999999991 },
  { 0.98109609144787457, -0.40000000000000036, 0.50000000000000000 },
  { 0.97281127049661942, -0.40000000000000036, 0.60000000000000009 },
  { 0.96304603930234189, -0.40000000000000036, 0.69999999999999996 },
  { 0.95181335823831092, -0.40000000000000036, 0.80000000000000004 },
  { 0.93912818070234538, -0.40000000000000036, 0.89999999999999991 },
  { 0.92500745190575495, -0.40000000000000036, 1.0000000000000000 },
};
const double toler007 = 0.050000000000000003;

// Test data for u=-0.29999999999999982.
// max(|f - f_GSL|): 0.011505291854497335
// max(|f - f_GSL| / |f_GSL|): 0.012026924691799125
const testcase_jacobi_dn<double>
data008[21] =
{
  { 0.95662791190024832, -0.29999999999999982, -1.0000000000000000 },
  { 0.96482341104348723, -0.29999999999999982, -0.90000000000000002 },
  { 0.97217418350150409, -0.29999999999999982, -0.80000000000000004 },
  { 0.97867425342693770, -0.29999999999999982, -0.69999999999999996 },
  { 0.98431834211641367, -0.29999999999999982, -0.59999999999999998 },
  { 0.98910187025283380, -0.29999999999999982, -0.50000000000000000 },
  { 0.99302095982817729, -0.29999999999999982, -0.40000000000000002 },
  { 0.99607243575548188, -0.29999999999999982, -0.30000000000000004 },
  { 0.99825382717743749, -0.29999999999999982, -0.19999999999999996 },
  { 0.99956336847773708, -0.29999999999999982, -0.099999999999999978 },
  { 1.0000000000000000, -0.29999999999999982, 0.0000000000000000 },
  { 0.99956336847773708, -0.29999999999999982, 0.10000000000000009 },
  { 0.99825382717743749, -0.29999999999999982, 0.19999999999999996 },
  { 0.99607243575548188, -0.29999999999999982, 0.30000000000000004 },
  { 0.99302095982817740, -0.29999999999999982, 0.39999999999999991 },
  { 0.98910187025283380, -0.29999999999999982, 0.50000000000000000 },
  { 0.98431834211641367, -0.29999999999999982, 0.60000000000000009 },
  { 0.97867425342693770, -0.29999999999999982, 0.69999999999999996 },
  { 0.97217418350150409, -0.29999999999999982, 0.80000000000000004 },
  { 0.96482341104348712, -0.29999999999999982, 0.89999999999999991 },
  { 0.95662791190024832, -0.29999999999999982, 1.0000000000000000 },
};
const double toler008 = 0.050000000000000003;

// Test data for u=-0.20000000000000018.
// max(|f - f_GSL|): 0.0055096184425983408
// max(|f - f_GSL| / |f_GSL|): 0.0056201786094403150
const testcase_jacobi_dn<double>
data009[21] =
{
  { 0.98032799764472534, -0.20000000000000018, -1.0000000000000000 },
  { 0.98405602896456645, -0.20000000000000018, -0.90000000000000002 },
  { 0.98739547051133281, -0.20000000000000018, -0.80000000000000004 },
  { 0.99034504565805404, -0.20000000000000018, -0.69999999999999996 },
  { 0.99290362704814483, -0.20000000000000018, -0.59999999999999998 },
  { 0.99507023694108865, -0.20000000000000018, -0.50000000000000000 },
  { 0.99684404751182876, -0.20000000000000018, -0.40000000000000002 },
  { 0.99822438110395695, -0.20000000000000018, -0.30000000000000004 },
  { 0.99921071043676934, -0.20000000000000018, -0.19999999999999996 },
  { 0.99980265876624497, -0.20000000000000018, -0.099999999999999978 },
  { 1.0000000000000000, -0.20000000000000018, 0.0000000000000000 },
  { 0.99980265876624497, -0.20000000000000018, 0.10000000000000009 },
  { 0.99921071043676934, -0.20000000000000018, 0.19999999999999996 },
  { 0.99822438110395695, -0.20000000000000018, 0.30000000000000004 },
  { 0.99684404751182865, -0.20000000000000018, 0.39999999999999991 },
  { 0.99507023694108865, -0.20000000000000018, 0.50000000000000000 },
  { 0.99290362704814483, -0.20000000000000018, 0.60000000000000009 },
  { 0.99034504565805404, -0.20000000000000018, 0.69999999999999996 },
  { 0.98739547051133281, -0.20000000000000018, 0.80000000000000004 },
  { 0.98405602896456645, -0.20000000000000018, 0.89999999999999991 },
  { 0.98032799764472534, -0.20000000000000018, 1.0000000000000000 },
};
const double toler009 = 0.050000000000000003;

// Test data for u=-0.099999999999999645.
// max(|f - f_GSL|): 0.0014388182624023305
// max(|f - f_GSL| / |f_GSL|): 0.0014460183507891509
const testcase_jacobi_dn<double>
data010[21] =
{
  { 0.99502074895322656, -0.099999999999999645, -1.0000000000000000 },
  { 0.99596617513124874, -0.099999999999999645, -0.90000000000000002 },
  { 0.99681233384486478, -0.099999999999999645, -0.80000000000000004 },
  { 0.99755914143205759, -0.099999999999999645, -0.69999999999999996 },
  { 0.99820652405485377, -0.099999999999999645, -0.59999999999999998 },
  { 0.99875441770627682, -0.099999999999999645, -0.50000000000000000 },
  { 0.99920276821637344, -0.099999999999999645, -0.40000000000000002 },
  { 0.99955153125731722, -0.099999999999999645, -0.30000000000000004 },
  { 0.99980067234757997, -0.099999999999999645, -0.19999999999999996 },
  { 0.99995016685518012, -0.099999999999999645, -0.099999999999999978 },
  { 1.0000000000000000, -0.099999999999999645, 0.0000000000000000 },
  { 0.99995016685518012, -0.099999999999999645, 0.10000000000000009 },
  { 0.99980067234757997, -0.099999999999999645, 0.19999999999999996 },
  { 0.99955153125731722, -0.099999999999999645, 0.30000000000000004 },
  { 0.99920276821637344, -0.099999999999999645, 0.39999999999999991 },
  { 0.99875441770627682, -0.099999999999999645, 0.50000000000000000 },
  { 0.99820652405485388, -0.099999999999999645, 0.60000000000000009 },
  { 0.99755914143205759, -0.099999999999999645, 0.69999999999999996 },
  { 0.99681233384486478, -0.099999999999999645, 0.80000000000000004 },
  { 0.99596617513124874, -0.099999999999999645, 0.89999999999999991 },
  { 0.99502074895322656, -0.099999999999999645, 1.0000000000000000 },
};
const double toler010 = 0.050000000000000003;

// Test data for u=0.0000000000000000.
// max(|f - f_GSL|): 0.0000000000000000
// max(|f - f_GSL| / |f_GSL|): 0.0000000000000000
const testcase_jacobi_dn<double>
data011[21] =
{
  { 1.0000000000000000, 0.0000000000000000, -1.0000000000000000 },
  { 1.0000000000000000, 0.0000000000000000, -0.90000000000000002 },
  { 1.0000000000000000, 0.0000000000000000, -0.80000000000000004 },
  { 1.0000000000000000, 0.0000000000000000, -0.69999999999999996 },
  { 1.0000000000000000, 0.0000000000000000, -0.59999999999999998 },
  { 1.0000000000000000, 0.0000000000000000, -0.50000000000000000 },
  { 1.0000000000000000, 0.0000000000000000, -0.40000000000000002 },
  { 1.0000000000000000, 0.0000000000000000, -0.30000000000000004 },
  { 1.0000000000000000, 0.0000000000000000, -0.19999999999999996 },
  { 1.0000000000000000, 0.0000000000000000, -0.099999999999999978 },
  { 1.0000000000000000, 0.0000000000000000, 0.0000000000000000 },
  { 1.0000000000000000, 0.0000000000000000, 0.10000000000000009 },
  { 1.0000000000000000, 0.0000000000000000, 0.19999999999999996 },
  { 1.0000000000000000, 0.0000000000000000, 0.30000000000000004 },
  { 1.0000000000000000, 0.0000000000000000, 0.39999999999999991 },
  { 1.0000000000000000, 0.0000000000000000, 0.50000000000000000 },
  { 1.0000000000000000, 0.0000000000000000, 0.60000000000000009 },
  { 1.0000000000000000, 0.0000000000000000, 0.69999999999999996 },
  { 1.0000000000000000, 0.0000000000000000, 0.80000000000000004 },
  { 1.0000000000000000, 0.0000000000000000, 0.89999999999999991 },
  { 1.0000000000000000, 0.0000000000000000, 1.0000000000000000 },
};
const double toler011 = 2.5000000000000020e-13;

// Test data for u=0.099999999999999645.
// max(|f - f_GSL|): 0.0014388182624023305
// max(|f - f_GSL| / |f_GSL|): 0.0014460183507891509
const testcase_jacobi_dn<double>
data012[21] =
{
  { 0.99502074895322656, 0.099999999999999645, -1.0000000000000000 },
  { 0.99596617513124874, 0.099999999999999645, -0.90000000000000002 },
  { 0.99681233384486478, 0.099999999999999645, -0.80000000000000004 },
  { 0.99755914143205759, 0.099999999999999645, -0.69999999999999996 },
  { 0.99820652405485377, 0.099999999999999645, -0.59999999999999998 },
  { 0.99875441770627682, 0.099999999999999645, -0.50000000000000000 },
  { 0.99920276821637344, 0.099999999999999645, -0.40000000000000002 },
  { 0.99955153125731722, 0.099999999999999645, -0.30000000000000004 },
  { 0.99980067234757997, 0.099999999999999645, -0.19999999999999996 },
  { 0.99995016685518012, 0.099999999999999645, -0.099999999999999978 },
  { 1.0000000000000000, 0.099999999999999645, 0.0000000000000000 },
  { 0.99995016685518012, 0.099999999999999645, 0.10000000000000009 },
  { 0.99980067234757997, 0.099999999999999645, 0.19999999999999996 },
  { 0.99955153125731722, 0.099999999999999645, 0.30000000000000004 },
  { 0.99920276821637344, 0.099999999999999645, 0.39999999999999991 },
  { 0.99875441770627682, 0.099999999999999645, 0.50000000000000000 },
  { 0.99820652405485388, 0.099999999999999645, 0.60000000000000009 },
  { 0.99755914143205759, 0.099999999999999645, 0.69999999999999996 },
  { 0.99681233384486478, 0.099999999999999645, 0.80000000000000004 },
  { 0.99596617513124874, 0.099999999999999645, 0.89999999999999991 },
  { 0.99502074895322656, 0.099999999999999645, 1.0000000000000000 },
};
const double toler012 = 0.050000000000000003;

// Test data for u=0.20000000000000018.
// max(|f - f_GSL|): 0.0055096184425983408
// max(|f - f_GSL| / |f_GSL|): 0.0056201786094403150
const testcase_jacobi_dn<double>
data013[21] =
{
  { 0.98032799764472534, 0.20000000000000018, -1.0000000000000000 },
  { 0.98405602896456645, 0.20000000000000018, -0.90000000000000002 },
  { 0.98739547051133281, 0.20000000000000018, -0.80000000000000004 },
  { 0.99034504565805404, 0.20000000000000018, -0.69999999999999996 },
  { 0.99290362704814483, 0.20000000000000018, -0.59999999999999998 },
  { 0.99507023694108865, 0.20000000000000018, -0.50000000000000000 },
  { 0.99684404751182876, 0.20000000000000018, -0.40000000000000002 },
  { 0.99822438110395695, 0.20000000000000018, -0.30000000000000004 },
  { 0.99921071043676934, 0.20000000000000018, -0.19999999999999996 },
  { 0.99980265876624497, 0.20000000000000018, -0.099999999999999978 },
  { 1.0000000000000000, 0.20000000000000018, 0.0000000000000000 },
  { 0.99980265876624497, 0.20000000000000018, 0.10000000000000009 },
  { 0.99921071043676934, 0.20000000000000018, 0.19999999999999996 },
  { 0.99822438110395695, 0.20000000000000018, 0.30000000000000004 },
  { 0.99684404751182865, 0.20000000000000018, 0.39999999999999991 },
  { 0.99507023694108865, 0.20000000000000018, 0.50000000000000000 },
  { 0.99290362704814483, 0.20000000000000018, 0.60000000000000009 },
  { 0.99034504565805404, 0.20000000000000018, 0.69999999999999996 },
  { 0.98739547051133281, 0.20000000000000018, 0.80000000000000004 },
  { 0.98405602896456645, 0.20000000000000018, 0.89999999999999991 },
  { 0.98032799764472534, 0.20000000000000018, 1.0000000000000000 },
};
const double toler013 = 0.050000000000000003;

// Test data for u=0.29999999999999982.
// max(|f - f_GSL|): 0.011505291854497335
// max(|f - f_GSL| / |f_GSL|): 0.012026924691799125
const testcase_jacobi_dn<double>
data014[21] =
{
  { 0.95662791190024832, 0.29999999999999982, -1.0000000000000000 },
  { 0.96482341104348723, 0.29999999999999982, -0.90000000000000002 },
  { 0.97217418350150409, 0.29999999999999982, -0.80000000000000004 },
  { 0.97867425342693770, 0.29999999999999982, -0.69999999999999996 },
  { 0.98431834211641367, 0.29999999999999982, -0.59999999999999998 },
  { 0.98910187025283380, 0.29999999999999982, -0.50000000000000000 },
  { 0.99302095982817729, 0.29999999999999982, -0.40000000000000002 },
  { 0.99607243575548188, 0.29999999999999982, -0.30000000000000004 },
  { 0.99825382717743749, 0.29999999999999982, -0.19999999999999996 },
  { 0.99956336847773708, 0.29999999999999982, -0.099999999999999978 },
  { 1.0000000000000000, 0.29999999999999982, 0.0000000000000000 },
  { 0.99956336847773708, 0.29999999999999982, 0.10000000000000009 },
  { 0.99825382717743749, 0.29999999999999982, 0.19999999999999996 },
  { 0.99607243575548188, 0.29999999999999982, 0.30000000000000004 },
  { 0.99302095982817740, 0.29999999999999982, 0.39999999999999991 },
  { 0.98910187025283380, 0.29999999999999982, 0.50000000000000000 },
  { 0.98431834211641367, 0.29999999999999982, 0.60000000000000009 },
  { 0.97867425342693770, 0.29999999999999982, 0.69999999999999996 },
  { 0.97217418350150409, 0.29999999999999982, 0.80000000000000004 },
  { 0.96482341104348712, 0.29999999999999982, 0.89999999999999991 },
  { 0.95662791190024832, 0.29999999999999982, 1.0000000000000000 },
};
const double toler014 = 0.050000000000000003;

// Test data for u=0.40000000000000036.
// max(|f - f_GSL|): 0.018340684372853633
// max(|f - f_GSL| / |f_GSL|): 0.019827607156101362
const testcase_jacobi_dn<double>
data015[21] =
{
  { 0.92500745190575495, 0.40000000000000036, -1.0000000000000000 },
  { 0.93912818070234527, 0.40000000000000036, -0.90000000000000002 },
  { 0.95181335823831092, 0.40000000000000036, -0.80000000000000004 },
  { 0.96304603930234189, 0.40000000000000036, -0.69999999999999996 },
  { 0.97281127049661942, 0.40000000000000036, -0.59999999999999998 },
  { 0.98109609144787457, 0.40000000000000036, -0.50000000000000000 },
  { 0.98788953548762481, 0.40000000000000036, -0.40000000000000002 },
  { 0.99318262995704742, 0.40000000000000036, -0.30000000000000004 },
  { 0.99696839627021794, 0.40000000000000036, -0.19999999999999996 },
  { 0.99924184984660724, 0.40000000000000036, -0.099999999999999978 },
  { 1.0000000000000000, 0.40000000000000036, 0.0000000000000000 },
  { 0.99924184984660724, 0.40000000000000036, 0.10000000000000009 },
  { 0.99696839627021794, 0.40000000000000036, 0.19999999999999996 },
  { 0.99318262995704742, 0.40000000000000036, 0.30000000000000004 },
  { 0.98788953548762470, 0.40000000000000036, 0.39999999999999991 },
  { 0.98109609144787457, 0.40000000000000036, 0.50000000000000000 },
  { 0.97281127049661942, 0.40000000000000036, 0.60000000000000009 },
  { 0.96304603930234189, 0.40000000000000036, 0.69999999999999996 },
  { 0.95181335823831092, 0.40000000000000036, 0.80000000000000004 },
  { 0.93912818070234538, 0.40000000000000036, 0.89999999999999991 },
  { 0.92500745190575495, 0.40000000000000036, 1.0000000000000000 },
};
const double toler015 = 0.050000000000000003;

// Test data for u=0.50000000000000000.
// max(|f - f_GSL|): 0.024673121699057998
// max(|f - f_GSL| / |f_GSL|): 0.027822052670554768
const testcase_jacobi_dn<double>
data016[21] =
{
  { 0.88681888397007402, 0.50000000000000000, -1.0000000000000000 },
  { 0.90805383458107469, 0.50000000000000000, -0.90000000000000002 },
  { 0.92716103522748838, 0.50000000000000000, -0.80000000000000004 },
  { 0.94410443489592599, 0.50000000000000000, -0.69999999999999996 },
  { 0.95885234505946271, 0.50000000000000000, -0.59999999999999998 },
  { 0.97137739883817886, 0.50000000000000000, -0.50000000000000000 },
  { 0.98165651255837094, 0.50000000000000000, -0.40000000000000002 },
  { 0.98967085099120156, 0.50000000000000000, -0.30000000000000004 },
  { 0.99540579737384005, 0.50000000000000000, -0.19999999999999996 },
  { 0.99885092912858620, 0.50000000000000000, -0.099999999999999978 },
  { 1.0000000000000000, 0.50000000000000000, 0.0000000000000000 },
  { 0.99885092912858620, 0.50000000000000000, 0.10000000000000009 },
  { 0.99540579737384005, 0.50000000000000000, 0.19999999999999996 },
  { 0.98967085099120156, 0.50000000000000000, 0.30000000000000004 },
  { 0.98165651255837105, 0.50000000000000000, 0.39999999999999991 },
  { 0.97137739883817886, 0.50000000000000000, 0.50000000000000000 },
  { 0.95885234505946249, 0.50000000000000000, 0.60000000000000009 },
  { 0.94410443489592599, 0.50000000000000000, 0.69999999999999996 },
  { 0.92716103522748838, 0.50000000000000000, 0.80000000000000004 },
  { 0.90805383458107469, 0.50000000000000000, 0.89999999999999991 },
  { 0.88681888397007402, 0.50000000000000000, 1.0000000000000000 },
};
const double toler016 = 0.050000000000000003;

// Test data for u=0.59999999999999964.
// max(|f - f_GSL|): 0.029038483766435919
// max(|f - f_GSL| / |f_GSL|): 0.034424112495602496
const testcase_jacobi_dn<double>
data017[21] =
{
  { 0.84355068762180685, 0.59999999999999964, -1.0000000000000000 },
  { 0.87281338478848958, 0.59999999999999964, -0.90000000000000002 },
  { 0.89918189933285819, 0.59999999999999964, -0.80000000000000004 },
  { 0.92259290662864846, 0.59999999999999964, -0.69999999999999996 },
  { 0.94299126446415793, 0.59999999999999964, -0.59999999999999998 },
  { 0.96032976181267005, 0.59999999999999964, -0.50000000000000000 },
  { 0.97456888555904098, 0.59999999999999964, -0.40000000000000002 },
  { 0.98567661175307120, 0.59999999999999964, -0.30000000000000004 },
  { 0.99362822702227538, 0.59999999999999964, -0.19999999999999996 },
  { 0.99840618479792842, 0.59999999999999964, -0.099999999999999978 },
  { 1.0000000000000000, 0.59999999999999964, 0.0000000000000000 },
  { 0.99840618479792842, 0.59999999999999964, 0.10000000000000009 },
  { 0.99362822702227538, 0.59999999999999964, 0.19999999999999996 },
  { 0.98567661175307120, 0.59999999999999964, 0.30000000000000004 },
  { 0.97456888555904120, 0.59999999999999964, 0.39999999999999991 },
  { 0.96032976181267005, 0.59999999999999964, 0.50000000000000000 },
  { 0.94299126446415804, 0.59999999999999964, 0.60000000000000009 },
  { 0.92259290662864846, 0.59999999999999964, 0.69999999999999996 },
  { 0.89918189933285819, 0.59999999999999964, 0.80000000000000004 },
  { 0.87281338478848969, 0.59999999999999964, 0.89999999999999991 },
  { 0.84355068762180685, 0.59999999999999964, 1.0000000000000000 },
};
const double toler017 = 0.050000000000000003;

// Test data for u=0.70000000000000018.
// max(|f - f_GSL|): 0.029982128801585906
// max(|f - f_GSL| / |f_GSL|): 0.037632638794585442
const testcase_jacobi_dn<double>
data018[21] =
{
  { 0.79670545999287490, 0.70000000000000018, -1.0000000000000000 },
  { 0.83465754721119778, 0.70000000000000018, -0.90000000000000002 },
  { 0.86889039930773859, 0.70000000000000018, -0.80000000000000004 },
  { 0.89930737730509924, 0.70000000000000018, -0.69999999999999996 },
  { 0.92582589832868323, 0.70000000000000018, -0.59999999999999998 },
  { 0.94837651273058077, 0.70000000000000018, -0.50000000000000000 },
  { 0.96690204766780252, 0.70000000000000018, -0.40000000000000002 },
  { 0.98135684150561997, 0.70000000000000018, -0.30000000000000004 },
  { 0.99170608961762485, 0.70000000000000018, -0.19999999999999996 },
  { 0.99792531833474940, 0.70000000000000018, -0.099999999999999978 },
  { 1.0000000000000000, 0.70000000000000018, 0.0000000000000000 },
  { 0.99792531833474940, 0.70000000000000018, 0.10000000000000009 },
  { 0.99170608961762485, 0.70000000000000018, 0.19999999999999996 },
  { 0.98135684150561997, 0.70000000000000018, 0.30000000000000004 },
  { 0.96690204766780241, 0.70000000000000018, 0.39999999999999991 },
  { 0.94837651273058077, 0.70000000000000018, 0.50000000000000000 },
  { 0.92582589832868334, 0.70000000000000018, 0.60000000000000009 },
  { 0.89930737730509924, 0.70000000000000018, 0.69999999999999996 },
  { 0.86889039930773859, 0.70000000000000018, 0.80000000000000004 },
  { 0.83465754721119778, 0.70000000000000018, 0.89999999999999991 },
  { 0.79670545999287490, 0.70000000000000018, 1.0000000000000000 },
};
const double toler018 = 0.050000000000000003;

// Test data for u=0.79999999999999982.
// max(|f - f_GSL|): 0.026169403758427134
// max(|f - f_GSL| / |f_GSL|): 0.034999875110481790
const testcase_jacobi_dn<double>
data019[21] =
{
  { 0.74769991823741966, 0.79999999999999982, -1.0000000000000000 },
  { 0.79479625944854992, 0.79999999999999982, -0.90000000000000002 },
  { 0.83729114994772580, 0.79999999999999982, -0.80000000000000004 },
  { 0.87505260553215503, 0.79999999999999982, -0.69999999999999996 },
  { 0.90797172770006129, 0.79999999999999982, -0.59999999999999998 },
  { 0.93596010327598267, 0.79999999999999982, -0.50000000000000000 },
  { 0.95894739155328479, 0.79999999999999982, -0.40000000000000002 },
  { 0.97687917024940485, 0.79999999999999982, -0.30000000000000004 },
  { 0.98971509848823991, 0.79999999999999982, -0.19999999999999996 },
  { 0.99742744271173889, 0.79999999999999982, -0.099999999999999978 },
  { 1.0000000000000000, 0.79999999999999982, 0.0000000000000000 },
  { 0.99742744271173889, 0.79999999999999982, 0.10000000000000009 },
  { 0.98971509848823991, 0.79999999999999982, 0.19999999999999996 },
  { 0.97687917024940485, 0.79999999999999982, 0.30000000000000004 },
  { 0.95894739155328479, 0.79999999999999982, 0.39999999999999991 },
  { 0.93596010327598267, 0.79999999999999982, 0.50000000000000000 },
  { 0.90797172770006118, 0.79999999999999982, 0.60000000000000009 },
  { 0.87505260553215503, 0.79999999999999982, 0.69999999999999996 },
  { 0.83729114994772580, 0.79999999999999982, 0.80000000000000004 },
  { 0.79479625944855004, 0.79999999999999982, 0.89999999999999991 },
  { 0.74769991823741966, 0.79999999999999982, 1.0000000000000000 },
};
const double toler019 = 0.050000000000000003;

// Test data for u=0.90000000000000036.
// max(|f - f_GSL|): 0.017221337601910025
// max(|f - f_GSL| / |f_GSL|): 0.023599848847669878
const testcase_jacobi_dn<double>
data020[21] =
{
  { 0.69779464110033207, 0.90000000000000036, -1.0000000000000000 },
  { 0.75433996484295673, 0.90000000000000036, -0.90000000000000002 },
  { 0.80533163253704532, 0.90000000000000036, -0.80000000000000004 },
  { 0.85060554010040512, 0.90000000000000036, -0.69999999999999996 },
  { 0.89003472239039971, 0.90000000000000036, -0.59999999999999998 },
  { 0.92352317760339009, 0.90000000000000036, -0.50000000000000000 },
  { 0.95100015407466965, 0.90000000000000036, -0.40000000000000002 },
  { 0.97241507337109867, 0.90000000000000036, -0.30000000000000004 },
  { 0.98773322313268241, 0.90000000000000036, -0.19999999999999996 },
  { 0.99693231826899864, 0.90000000000000036, -0.099999999999999978 },
  { 1.0000000000000000, 0.90000000000000036, 0.0000000000000000 },
  { 0.99693231826899864, 0.90000000000000036, 0.10000000000000009 },
  { 0.98773322313268241, 0.90000000000000036, 0.19999999999999996 },
  { 0.97241507337109867, 0.90000000000000036, 0.30000000000000004 },
  { 0.95100015407466965, 0.90000000000000036, 0.39999999999999991 },
  { 0.92352317760339009, 0.90000000000000036, 0.50000000000000000 },
  { 0.89003472239039971, 0.90000000000000036, 0.60000000000000009 },
  { 0.85060554010040512, 0.90000000000000036, 0.69999999999999996 },
  { 0.80533163253704532, 0.90000000000000036, 0.80000000000000004 },
  { 0.75433996484295696, 0.90000000000000036, 0.89999999999999991 },
  { 0.69779464110033207, 0.90000000000000036, 1.0000000000000000 },
};
const double toler020 = 0.050000000000000003;

// Test data for u=1.0000000000000000.
// max(|f - f_GSL|): 0.029982128801585795
// max(|f - f_GSL| / |f_GSL|): 0.036267786293136484
const testcase_jacobi_dn<double>
data021[21] =
{
  { 0.64805427366388546, 1.0000000000000000, -1.0000000000000000 },
  { 0.71426248915701351, 1.0000000000000000, -0.90000000000000002 },
  { 0.77386932199584635, 1.0000000000000000, -0.80000000000000004 },
  { 0.82668758879446080, 1.0000000000000000, -0.69999999999999996 },
  { 0.87258917138824266, 1.0000000000000000, -0.59999999999999998 },
  { 0.91149200566913202, 1.0000000000000000, -0.50000000000000000 },
  { 0.94334813627860858, 1.0000000000000000, -0.40000000000000002 },
  { 0.96813320375474532, 1.0000000000000000, -0.30000000000000004 },
  { 0.98583761608732368, 1.0000000000000000, -0.19999999999999996 },
  { 0.99645956721562878, 1.0000000000000000, -0.099999999999999978 },
  { 1.0000000000000000, 1.0000000000000000, 0.0000000000000000 },
  { 0.99645956721562878, 1.0000000000000000, 0.10000000000000009 },
  { 0.98583761608732368, 1.0000000000000000, 0.19999999999999996 },
  { 0.96813320375474532, 1.0000000000000000, 0.30000000000000004 },
  { 0.94334813627860858, 1.0000000000000000, 0.39999999999999991 },
  { 0.91149200566913202, 1.0000000000000000, 0.50000000000000000 },
  { 0.87258917138824266, 1.0000000000000000, 0.60000000000000009 },
  { 0.82668758879446080, 1.0000000000000000, 0.69999999999999996 },
  { 0.77386932199584635, 1.0000000000000000, 0.80000000000000004 },
  { 0.71426248915701362, 1.0000000000000000, 0.89999999999999991 },
  { 0.64805427366388546, 1.0000000000000000, 1.0000000000000000 },
};
const double toler021 = 0.050000000000000003;

template<typename Tp, unsigned int Num>
  void
  test(const testcase_jacobi_dn<Tp> (&data)[Num], Tp toler)
  {
    bool test __attribute__((unused)) = true;
    const Tp eps = std::numeric_limits<Tp>::epsilon();
    Tp max_abs_diff = -Tp(1);
    Tp max_abs_frac = -Tp(1);
    unsigned int num_datum = Num;
    for (unsigned int i = 0; i < num_datum; ++i)
      {
	const Tp f = __gnu_cxx::jacobi_dn(data[i].u, data[i].k);
	const Tp f0 = data[i].f0;
	const Tp diff = f - f0;
	if (std::abs(diff) > max_abs_diff)
	  max_abs_diff = std::abs(diff);
	if (std::abs(f0) > Tp(10) * eps
	 && std::abs(f) > Tp(10) * eps)
	  {
	    const Tp frac = diff / f0;
	    if (std::abs(frac) > max_abs_frac)
	      max_abs_frac = std::abs(frac);
	  }
      }
    VERIFY(max_abs_frac < toler);
  }

int
main()
{
  test(data001, toler001);
  test(data002, toler002);
  test(data003, toler003);
  test(data004, toler004);
  test(data005, toler005);
  test(data006, toler006);
  test(data007, toler007);
  test(data008, toler008);
  test(data009, toler009);
  test(data010, toler010);
  test(data011, toler011);
  test(data012, toler012);
  test(data013, toler013);
  test(data014, toler014);
  test(data015, toler015);
  test(data016, toler016);
  test(data017, toler017);
  test(data018, toler018);
  test(data019, toler019);
  test(data020, toler020);
  test(data021, toler021);
  return 0;
}
