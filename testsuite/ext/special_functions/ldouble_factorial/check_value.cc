// { dg-options "-D__STDCPP_WANT_MATH_SPEC_FUNCS__" }
//
// Copyright (C) 2016 Free Software Foundation, Inc.
//
// This file is part of the GNU ISO C++ Library.  This library is free
// software; you can redistribute it and/or modify it under the
// terms of the GNU General Public License as published by the
// Free Software Foundation; either version 3, or (at your option)
// any later version.
//
// This library is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this library; see the file COPYING3.  If not see
// <http://www.gnu.org/licenses/>.

//  ldouble_factorial

//  Compare against values generated by the GNU Scientific Library.
//  The GSL can be found on the web: http://www.gnu.org/software/gsl/
#include <limits>
#include <cmath>
#if defined(__TEST_DEBUG)
#  include <iostream>
#  define VERIFY(A) \
  if (!(A)) \
    { \
      std::cout << "line " << __LINE__ \
	<< "  max_abs_frac = " << max_abs_frac \
	<< std::endl; \
    }
#else
#  include <testsuite_hooks.h>
#endif
#include <specfun_testcase.h>

// Test data.
// max(|f - f_GSL|): 711.62077727640133
// max(|f - f_GSL| / |f_GSL|): 4.3696269442447574e-16
const testcase_ldouble_factorial<double>
data001[501] =
{
  { 0.0000000000000000, 0 },
  { 0.0000000000000000, 1 },
  { 0.69314718055994529, 2 },
  { 1.0986122886681098, 3 },
  { 2.0794415416798357, 4 },
  { 2.7080502011022101, 5 },
  { 3.8712010109078911, 6 },
  { 4.6539603501575231, 7 },
  { 5.9506425525877269, 8 },
  { 6.8511849274937431, 9 },
  { 8.2532276455817719, 10 },
  { 9.2490802002921129, 11 },
  { 10.738134295369774, 12 },
  { 11.814029557753649, 13 },
  { 13.377191624985031, 14 },
  { 14.522079758855860, 15 },
  { 16.149780347224812, 16 },
  { 17.355293102912075, 17 },
  { 19.040152105120978, 18 },
  { 20.299732082078517, 19 },
  { 22.035884378674968, 20 },
  { 23.344254519801940, 21 },
  { 25.126926832033284, 22 },
  { 26.479748735731089, 23 },
  { 28.304980662381229, 24 },
  { 29.698624560599288, 25 },
  { 31.563077200402713, 26 },
  { 32.994461426603621, 27 },
  { 34.895281710577919, 28 },
  { 36.361757256590096, 29 },
  { 38.296479092240070, 30 },
  { 39.795744461075238, 31 },
  { 41.762214995039798, 32 },
  { 43.292252022541717, 33 },
  { 45.288575519655957, 34 },
  { 46.847600084031136, 35 },
  { 48.872094458112066, 36 },
  { 50.458517996675354, 37 },
  { 52.509680617838455, 38 },
  { 54.122079642805005, 39 },
  { 56.198560071952393, 40 },
  { 57.835651709509314, 41 },
  { 59.936229690235763, 42 },
  { 61.596851825202876, 43 },
  { 63.720419324154022, 44 },
  { 65.403514314973194, 45 },
  { 67.549060720643112, 46 },
  { 69.253661916683257, 47 },
  { 71.420261731551008, 48 },
  { 73.145482214793873, 49 },
  { 75.332284736979148, 50 },
  { 77.077307847518199, 51 },
  { 79.283528455560585, 52 },
  { 81.047599761070330, 53 },
  { 83.272512502124854, 54 },
  { 85.054932946302799, 55 },
  { 87.297864192860004, 56 },
  { 89.097984214137341, 57 },
  { 91.358307203406426, 58 },
  { 93.175521658043067, 59 },
  { 95.452651765628531, 60 },
  { 97.286395522216381, 61 },
  { 99.579786150673613, 62 },
  { 101.42953024860792, 63 },
  { 103.73866923403328, 64 },
  { 105.60391751850355, 65 },
  { 107.92832397605972, 66 },
  { 109.80861013789452, 67 },
  { 112.14783168123581, 68 },
  { 114.04271664249177, 69 },
  { 116.39632692328517, 70 },
  { 118.30539651953309, 71 },
  { 120.67299304230123, 72 },
  { 122.59585596068148, 73 },
  { 124.97705813550540, 74 },
  { 126.91334407421779, 75 },
  { 129.30779147579173, 76 },
  { 131.25714949607146, 77 },
  { 133.66450030248131, 78 },
  { 135.62659734853850, 79 },
  { 138.04652693715522, 80 },
  { 140.02104650321093, 81 },
  { 142.45324618441947, 82 },
  { 144.43988711100752, 83 },
  { 146.88406298326277, 84 },
  { 148.88253836749786, 85 },
  { 151.33841027951630, 86 },
  { 153.34844648615243, 87 },
  { 155.81574709399450, 88 },
  { 157.83708285588457, 89 },
  { 160.31555676432475, 90 },
  { 162.34794236240143, 91 },
  { 164.83734534137380, 92 },
  { 166.88054185555467, 93 },
  { 169.38064012364379, 94 },
  { 171.43441874715521, 95 },
  { 173.94498831511163, 96 },
  { 176.00912972565860, 97 },
  { 178.52995579378219, 98 },
  { 180.60424957579320, 99 },
  { 183.13512597977029, 100 },
  { 185.21937009263445, 101 },
  { 187.76009879305457, 102 },
  { 189.85409908086407, 103 },
  { 192.40448969219594, 104 },
  { 194.50805943102162, 105 },
  { 197.06792878630802, 106 },
  { 199.18088826548350, 107 },
  { 201.75006001343223, 108 },
  { 203.87223614771267, 109 },
  { 206.45054037922463, 110 },
  { 208.58176634902500, 111 },
  { 211.16903925051975, 112 },
  { 213.30915416773735, 113 },
  { 215.90523769891422, 114 },
  { 218.05408629610059, 115 },
  { 220.65882789002060, 116 },
  { 222.81626023089834, 117 },
  { 225.42951251448628, 118 },
  { 227.59538372400988, 119 },
  { 230.21700425726831, 120 },
  { 232.39117426960661, 121 },
  { 235.02102530200156, 122 },
  { 237.20335862497902, 123 },
  { 239.84130686760659, 124 },
  { 242.03167236228134, 125 },
  { 244.67758877455807, 126 },
  { 246.87585944873993, 127 },
  { 249.52961903847770, 128 },
  { 251.73567185310159, 129 },
  { 254.39715348893327, 130 },
  { 256.61086917630274, 131 },
  { 259.27995541151967, 132 },
  { 261.50121830452451, 133 },
  { 264.17779521147054, 134 },
  { 266.40649308296292, 135 },
  { 269.09045009720660, 136 },
  { 271.32647400879108, 137 },
  { 274.01770378236381, 138 },
  { 276.26094794192176, 139 },
  { 278.95934620497314, 140 },
  { 281.20970783229990, 141 },
  { 283.91517326257440, 142 },
  { 286.17255246255985, 143 },
  { 288.88498656215040, 144 },
  { 291.14928620498040, 145 },
  { 293.86859318385871, 146 },
  { 296.13971879175915, 147 },
  { 298.86580545762286, 148 },
  { 301.14366509770457, 149 },
  { 303.87644075171909, 150 },
  { 306.16094493451953, 151 },
  { 308.90032127256535, 152 },
  { 311.19138285591197, 153 },
  { 313.93727387497898, 154 },
  { 316.23480797283122, 155 },
  { 318.98712988222854, 156 },
  { 321.29105377817950, 157 },
  { 324.04972491525552, 158 },
  { 326.35995798039971, 159 },
  { 329.12489873048935, 160 },
  { 331.44136234538422, 161 },
  { 334.21249506572173, 162 },
  { 336.53511254619099, 163 },
  { 339.31236149354589, 164 },
  { 341.64105802009152, 165 },
  { 344.42434928190244, 166 },
  { 346.75905183250831, 167 },
  { 349.54831326130574, 168 },
  { 351.88895054743136, 169 },
  { 354.68411169835599, 170 },
  { 357.03061410393406, 171 },
  { 359.83160617516944, 172 },
  { 362.18390569843183, 173 },
  { 364.99066147438396, 174 },
  { 367.34869167235530, 175 },
  { 370.16114546942208, 176 },
  { 372.52484140492913, 177 },
  { 375.34292901971418, 178 },
  { 377.71222721076992, 179 },
  { 380.53588587060443, 180 },
  { 382.91072424203571, 181 },
  { 385.73989255768117, 182 },
  { 388.12021039487718, 183 },
  { 390.95482831529017, 184 },
  { 393.34056621995546, 185 },
  { 396.18057498900339, 186 },
  { 398.57167483681008, 187 },
  { 401.41701695183332, 188 },
  { 403.81342185186969, 189 },
  { 406.66404102399383, 190 },
  { 409.06569527991633, 191 },
  { 411.92153639602162, 192 },
  { 414.32838546882124, 193 },
  { 417.18939455508496, 194 },
  { 419.60138502738499, 195 },
  { 422.46750921431544, 196 },
  { 424.88458875612298, 197 },
  { 427.75577624501000, 198 },
  { 430.17789358084747, 199 },
  { 433.05409361155802, 200 },
  { 435.48119848890650, 201 },
  { 438.36236130895924, 202 },
  { 440.79440446794831, 203 },
  { 443.68048130280346, 204 },
  { 446.11741444708673, 205 },
  { 449.00835747159300, 206 },
  { 451.45013324035210, 207 },
  { 454.34589555129435, 208 },
  { 456.79246749231692, 209 },
  { 459.69300308201178, 210 },
  { 462.14432562579299, 211 },
  { 465.04958935668384, 212 },
  { 467.50561779150240, 213 },
  { 470.41556537170567, 214 },
  { 472.87625581963005, 215 },
  { 475.79084377938983, 216 },
  { 478.25615317317050, 217 },
  { 481.17533884217892, 218 },
  { 483.64522490298702, 219 },
  { 486.56896638853129, 220 },
  { 489.04338760450474, 221 },
  { 491.97164377040355, 222 },
  { 494.45055937596487, 223 },
  { 497.38328982225863, 224 },
  { 499.86665977816932, 225 },
  { 502.80382482153090, 226 },
  { 505.29160979565069, 227 },
  { 508.23317045048532, 228 },
  { 510.72533179920498, 229 },
  { 513.67124975940851, 230 },
  { 516.16774950972672, 231 },
  { 519.11798713107487, 232 },
  { 521.61878796329245, 233 },
  { 524.57330824643259, 234 },
  { 527.07837347743657, 235 },
  { 530.03714005145810, 236 },
  { 532.54643361857177, 237 },
  { 535.50941072512967, 238 },
  { 538.02289717050326, 239 },
  { 540.99004964847165, 240 },
  { 543.50769410399391, 241 },
  { 546.47898737462833, 242 },
  { 549.00075554733451, 243 },
  { 551.97615559992153, 244 },
  { 554.50201375787913, 245 },
  { 557.48148713585385, 246 },
  { 560.01140209450716, 247 },
  { 562.99491588201886, 248 },
  { 565.52885499097181, 249 },
  { 568.51637679988107, 250 },
  { 571.05430793010362, 251 },
  { 574.04580588739248, 252 },
  { 576.58769741883111, 253 },
  { 579.58314015441101, 254 },
  { 582.12896096398958, 255 },
  { 585.12831759889059, 256 },
  { 587.67803704888479, 257 },
  { 590.68127718381220, 258 },
  { 593.23486511058434, 259 },
  { 596.24195881482774, 260 },
  { 598.79938551790701, 261 },
  { 601.81030331858881, 262 },
  { 604.37153955008478, 263 },
  { 607.38625242173521, 264 },
  { 609.95126937607108, 265 },
  { 612.96974873051693, 266 },
  { 615.53851803447128, 267 },
  { 618.56073571102775, 268 },
  { 621.13322941407307, 269 },
  { 624.15915767002616, 270 },
  { 626.73534823495277, 271 },
  { 629.76495973632211, 272 },
  { 632.34482003013773, 273 },
  { 635.37808784271022, 274 },
  { 637.96159112780435, 275 },
  { 640.99848870842732, 276 },
  { 643.58560863399168, 277 },
  { 646.62610982211800, 278 },
  { 649.21682041581300, 279 },
  { 652.26089942528722, 280 },
  { 654.85517508514681, 281 },
  { 657.90280649622537, 282 },
  { 660.50062198278999, 283 },
  { 663.55178073438651, 284 },
  { 666.15311116305872, 285 },
  { 669.20777254520635, 286 },
  { 671.81259337881829, 287 },
  { 674.87073302534236, 288 },
  { 677.47902006693073, 289 },
  { 680.54061394832286, 290 },
  { 683.15234333410228, 291 },
  { 686.21736775059117, 292 },
  { 688.83251594311935, 293 },
  { 691.90094751792981, 294 },
  { 694.51949129945910, 295 },
  { 697.59130697225385, 296 },
  { 700.21322343826182, 297 },
  { 703.28840045875927, 298 },
  { 705.91366701165236, 299 },
  { 708.99218293341528, 300 },
  { 711.62077727640133, 301 },
  { 714.70260995079025, 302 },
  { 717.33451008191059, 303 },
  { 720.41963765219657, 304 },
  { 723.05482185851804, 305 },
  { 726.14322275414884, 306 },
  { 728.78166960610531, 307 },
  { 731.87332253712248, 308 },
  { 734.51501088300301, 309 },
  { 737.60989483460150, 310 },
  { 740.25480379518228, 311 },
  { 743.35289802241107, 312 },
  { 746.00100698572237, 313 },
  { 749.10229100831930, 314 },
  { 751.75357962454791, 315 },
  { 754.85803322190623, 316 },
  { 757.51248139842528, 317 },
  { 760.62008460468644, 318 },
  { 763.27767250121019, 319 },
  { 766.38840560048016, 320 },
  { 769.04911362434018, 321 },
  { 772.16295714602461, 322 },
  { 774.82676594756288, 323 },
  { 777.94370066181682, 324 },
  { 780.61059112989255, 325 },
  { 783.73059804318370, 326 },
  { 786.40055130078997, 327 },
  { 789.52361165156788, 328 },
  { 792.19660905155513, 329 },
  { 795.32270430602841, 330 },
  { 797.99872742693231, 331 },
  { 801.12783927494479, 332 },
  { 803.80686991691266, 333 },
  { 806.93898026792147, 334 },
  { 809.62100044873785, 335 },
  { 812.75609142788471, 336 },
  { 815.44108337909017, 337 },
  { 818.57913732336772, 338 },
  { 821.26708348647048, 339 },
  { 824.40808294097792, 340 },
  { 827.09896596375404, 341 },
  { 830.24289367804067, 342 },
  { 832.93669641092004, 343 },
  { 836.08353533541401, 344 },
  { 838.78024082795127, 345 },
  { 841.92997411047179, 346 },
  { 844.62956560789826, 347 },
  { 847.78217659024608, 348 },
  { 850.48463753010071, 349 },
  { 853.64010974472967, 350 },
  { 856.34542375356659, 351 },
  { 859.50374092032780, 352 },
  { 862.21189181049988, 353 },
  { 865.37303783346147, 354 },
  { 868.08400959997539, 355 },
  { 871.24796856431340, 356 },
  { 873.96174538175489, 357 },
  { 877.12850155071419, 358 },
  { 879.84506777024319, 359 },
  { 883.01460558216434, 360 },
  { 885.73394572857603, 361 },
  { 888.90624979399013, 362 },
  { 891.62834856284098, 363 },
  { 894.80340366162693, 364 },
  { 897.52824591642332, 365 },
  { 900.70603699502817, 366 },
  { 903.43360776447798, 367 },
  { 906.61411993319712, 368 },
  { 909.34440440851847, 369 },
  { 912.52762293883552, 370 },
  { 915.26060647112581, 371 },
  { 918.44651679310869, 372 },
  { 921.18218489076980, 373 },
  { 924.37077259052307, 374 },
  { 927.10911091674006, 375 },
  { 930.30036173391295, 376 },
  { 933.04135610418825, 377 },
  { 936.23525592953251, 378 },
  { 938.97889230927046, 379 },
  { 942.17542718225297, 380 },
  { 944.92169168439727, 381 },
  { 948.12084779085956, 382 },
  { 950.86972667357782, 383 },
  { 954.07149034344741, 384 },
  { 956.82297000786582, 385 },
  { 960.02732771291210, 386 },
  { 962.78139470089548, 387 },
  { 965.98833305253549, 388 },
  { 968.74497404451404, 389 },
  { 971.95447979165920, 390 },
  { 974.71368160449924, 391 },
  { 977.92574163144968, 392 },
  { 980.68749121636847, 393 },
  { 983.90209254074750, 394 },
  { 986.66637698126965, 395 },
  { 989.88350675200218, 396 },
  { 992.65031326195685, 397 },
  { 995.86995875728655, 398 },
  { 998.63927467884662, 399 },
  { 1001.8614233043945, 400 },
  { 1004.6332361061533, 401 },
  { 1007.8578753930135, 402 },
  { 1010.6321726681000, 403 },
  { 1013.8592902709745, 404 },
  { 1016.6360597352066, 405 },
  { 1019.8656434305764, 406 },
  { 1022.6448729206492, 407 },
  { 1025.8769106049806, 408 },
  { 1028.6585880766920, 409 },
  { 1031.8930677646790, 410 },
  { 1034.6771812911882, 411 },
  { 1037.9140911140285, 412 },
  { 1040.7006288841490, 413 },
  { 1043.9399570878536, 414 },
  { 1046.7289074043797, 415 },
  { 1049.9706423481150, 416 },
  { 1052.7619936261788, 417 },
  { 1056.0061237806397, 418 },
  { 1058.7998645461007, 419 },
  { 1062.0463784919170, 420 },
  { 1064.8424973797833, 421 },
  { 1068.0913838059530, 422 },
  { 1070.8898695588296, 423 },
  { 1074.1411172611849, 424 },
  { 1076.9419587277541, 425 },
  { 1080.1955566074544, 426 },
  { 1082.9987427409824, 427 },
  { 1086.2546798030362, 428 },
  { 1089.0601996599105, 429 },
  { 1092.3184650117237, 430 },
  { 1095.1263077500143, 431 },
  { 1098.3868905999680, 432 },
  { 1101.1970454780167, 433 },
  { 1104.4599351340685, 434 },
  { 1107.2723915091055, 435 },
  { 1110.5375773774174, 436 },
  { 1113.3523247042010, 437 },
  { 1116.6197962877939, 438 },
  { 1119.4368241172763, 439 },
  { 1122.7065710147060, 440 },
  { 1125.5258689927232, 441 },
  { 1128.7978808967839, 442 },
  { 1131.6194387627681, 443 },
  { 1134.8937054592161, 444 },
  { 1137.7175130449345, 445 },
  { 1140.9940244112361, 446 },
  { 1143.8200716395479, 447 },
  { 1147.0988176436510, 448 },
  { 1149.9270945272901, 449 },
  { 1153.2080652264156, 450 },
  { 1156.0385618667931, 451 },
  { 1159.3217474062478, 452 },
  { 1162.1544539922761, 453 },
  { 1165.4398446042890, 454 },
  { 1168.2747514112268, 455 },
  { 1171.5623374138036, 456 },
  { 1174.3994348021213, 457 },
  { 1177.6892065979175, 458 },
  { 1180.5284850121818, 459 },
  { 1183.8204330874009, 460 },
  { 1186.6618830551786, 461 },
  { 1189.9559979784826, 462 },
  { 1192.7996101092647, 463 },
  { 1196.0958825307089, 464 },
  { 1198.9416475148519, 465 },
  { 1202.2400681648342, 466 },
  { 1205.0879767725207, 467 },
  { 1208.3885364607522, 468 },
  { 1211.2385795409673, 469 },
  { 1214.5412691554561, 470 },
  { 1217.3934376349835, 471 },
  { 1220.6982481410416, 472 },
  { 1223.5525330234755, 473 },
  { 1226.8594554627366, 474 },
  { 1229.7158478275101, 475 },
  { 1233.0248733169678, 476 },
  { 1235.8833643183984, 477 },
  { 1239.1944840494598, 478 },
  { 1242.0550649158095, 479 },
  { 1245.3682701533617, 480 },
  { 1248.2309321859152, 481 },
  { 1251.5462142674121, 482 },
  { 1254.4109488395675, 483 },
  { 1257.7282991741290, 484 },
  { 1260.5950977305051, 485 },
  { 1263.9145077980293, 486 },
  { 1266.7833618535878, 487 },
  { 1270.1048232038825, 488 },
  { 1272.9757243430627, 489 },
  { 1276.2992285949872, 490 },
  { 1279.1721684708571, 491 },
  { 1282.4977073114796, 492 },
  { 1285.3726776448998, 493 },
  { 1288.7002428286673, 494 },
  { 1291.5772354074686, 495 },
  { 1294.9068187553924, 496 },
  { 1297.7858254335649, 497 },
  { 1301.1174188324169, 498 },
  { 1303.9984315293168, 499 },
  { 1307.3320269308390, 500 },
};
const double toler001 = 2.5000000000000020e-13;

template<typename Tp, unsigned int Num>
  void
  test(const testcase_ldouble_factorial<Tp> (&data)[Num], Tp toler)
  {
    bool test __attribute__((unused)) = true;
    const Tp eps = std::numeric_limits<Tp>::epsilon();
    Tp max_abs_diff = -Tp(1);
    Tp max_abs_frac = -Tp(1);
    unsigned int num_datum = Num;
    for (unsigned int i = 0; i < num_datum; ++i)
      {
	const Tp f = __gnu_cxx::ldouble_factorial<Tp>(data[i].n);
	const Tp f0 = data[i].f0;
	const Tp diff = f - f0;
	if (std::abs(diff) > max_abs_diff)
	  max_abs_diff = std::abs(diff);
	if (std::abs(f0) > Tp(10) * eps
	 && std::abs(f) > Tp(10) * eps)
	  {
	    const Tp frac = diff / f0;
	    if (std::abs(frac) > max_abs_frac)
	      max_abs_frac = std::abs(frac);
	  }
      }
    VERIFY(max_abs_frac < toler);
  }

int
main()
{
  test(data001, toler001);
  return 0;
}
