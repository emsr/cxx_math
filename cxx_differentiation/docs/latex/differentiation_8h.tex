\hypertarget{differentiation_8h}{}\doxysection{include/emsr/differentiation.h File Reference}
\label{differentiation_8h}\index{include/emsr/differentiation.h@{include/emsr/differentiation.h}}
{\ttfamily \#include $<$ext/differentiation.\+tcc$>$}\newline
Include dependency graph for differentiation.\+h\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=241pt]{differentiation_8h__incl}
\end{center}
\end{figure}
\doxysubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structderivative__t}{derivative\+\_\+t$<$ Tp $>$}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$typename Func , typename Tp $>$ }\\\mbox{\hyperlink{structderivative__t}{derivative\+\_\+t}}$<$ Tp $>$ \mbox{\hyperlink{differentiation_8h_a6ab76f5ee2c247487dd77d4a1ac0d023}{derivative\+\_\+central}} (Func func, Tp x, Tp h)
\item 
{\footnotesize template$<$typename Func , typename Tp $>$ }\\\mbox{\hyperlink{structderivative__t}{derivative\+\_\+t}}$<$ Tp $>$ \mbox{\hyperlink{differentiation_8h_a2fd096a92e6b977a98fd7d16a04dc8b4}{derivative\+\_\+forward}} (Func func, Tp x, Tp h)
\item 
{\footnotesize template$<$typename Func , typename Tp $>$ }\\\mbox{\hyperlink{structderivative__t}{derivative\+\_\+t}}$<$ Tp $>$ \mbox{\hyperlink{differentiation_8h_a365faf5a5284666f8308582c2e1d8048}{derivative\+\_\+backward}} (Func func, Tp x, Tp h)
\item 
{\footnotesize template$<$typename Func , typename Tp $>$ }\\\mbox{\hyperlink{structderivative__t}{derivative\+\_\+t}}$<$ Tp $>$ \mbox{\hyperlink{differentiation_8h_ad773ecd26f4d7a6754acecdc833639a2}{derivative\+\_\+ridder}} (Func func, Tp x, Tp h)
\item 
{\footnotesize template$<$typename Func , typename Tp $>$ }\\\mbox{\hyperlink{structderivative__t}{derivative\+\_\+t}}$<$ Tp $>$ \mbox{\hyperlink{differentiation_8h_a03f1970cde537ff0aef96f4b9af8a06e}{derivative\+\_\+automatic}} (Func func, Tp x, Tp)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
This file contains the declarations and the inline implementations of the differentiation data structures and routines. 

\doxysubsection{Function Documentation}
\mbox{\Hypertarget{differentiation_8h_a03f1970cde537ff0aef96f4b9af8a06e}\label{differentiation_8h_a03f1970cde537ff0aef96f4b9af8a06e}} 
\index{differentiation.h@{differentiation.h}!derivative\_automatic@{derivative\_automatic}}
\index{derivative\_automatic@{derivative\_automatic}!differentiation.h@{differentiation.h}}
\doxysubsubsection{\texorpdfstring{derivative\_automatic()}{derivative\_automatic()}}
{\footnotesize\ttfamily template$<$typename Func , typename Tp $>$ \\
\mbox{\hyperlink{structderivative__t}{derivative\+\_\+t}}$<$Tp$>$ derivative\+\_\+automatic (\begin{DoxyParamCaption}\item[{Func}]{func,  }\item[{Tp}]{x,  }\item[{Tp}]{ }\end{DoxyParamCaption})}

Compute the derivative of a function func at a point x by automatic differentiation\+: \[ f\textnormal{\textquotesingle}(x) = Im[f(x + i\epsilon)] / \epsilon \] This routine ignores the input stepsize and uses machine epsilon.

If your function has complex overloads and works at least very near the real axis this is a very accurate routine.


\begin{DoxyTemplParams}{Template Parameters}
{\em Func} & A function type callable with a numeric type and returning the same. \\
\hline
{\em Tp} & The foating point type of the argument and stepsize.\\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}{Parameters}
{\em func} & The function to be differentated. \\
\hline
{\em x} & The (real) location at which the derivative is required. \\
\hline
{\em h} & The initial stepsize. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{differentiation_8h_a365faf5a5284666f8308582c2e1d8048}\label{differentiation_8h_a365faf5a5284666f8308582c2e1d8048}} 
\index{differentiation.h@{differentiation.h}!derivative\_backward@{derivative\_backward}}
\index{derivative\_backward@{derivative\_backward}!differentiation.h@{differentiation.h}}
\doxysubsubsection{\texorpdfstring{derivative\_backward()}{derivative\_backward()}}
{\footnotesize\ttfamily template$<$typename Func , typename Tp $>$ \\
\mbox{\hyperlink{structderivative__t}{derivative\+\_\+t}}$<$Tp$>$ derivative\+\_\+backward (\begin{DoxyParamCaption}\item[{Func}]{func,  }\item[{Tp}]{x,  }\item[{Tp}]{h }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Compute the derivative using the 4-\/point rule (x -\/ h/4, x -\/ h/2, x -\/ 3h/4, x -\/ h).

Compute the error using the difference between the 4-\/point and the 2-\/point rule (x -\/ h/2, x -\/ h).

i.\+e. run the forward differentiator with negative stepsize.


\begin{DoxyTemplParams}{Template Parameters}
{\em Func} & A function type callable with a numeric type and returning the same. \\
\hline
{\em Tp} & The foating point type of the argument and stepsize.\\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}{Parameters}
{\em func} & The function to be differentated. \\
\hline
{\em x} & The location at which the derivative is required. \\
\hline
{\em h} & The stepsize. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{differentiation_8h_a6ab76f5ee2c247487dd77d4a1ac0d023}\label{differentiation_8h_a6ab76f5ee2c247487dd77d4a1ac0d023}} 
\index{differentiation.h@{differentiation.h}!derivative\_central@{derivative\_central}}
\index{derivative\_central@{derivative\_central}!differentiation.h@{differentiation.h}}
\doxysubsubsection{\texorpdfstring{derivative\_central()}{derivative\_central()}}
{\footnotesize\ttfamily template$<$typename Func , typename Tp $>$ \\
\mbox{\hyperlink{structderivative__t}{derivative\+\_\+t}}$<$Tp$>$ derivative\+\_\+central (\begin{DoxyParamCaption}\item[{Func}]{func,  }\item[{Tp}]{x,  }\item[{Tp}]{h }\end{DoxyParamCaption})}

Compute the derivative using the 5-\/point rule (x-\/h, x-\/h/2, x, x+h/2, x+h). Note that the central point is not used.

Compute the error using the difference between the 5-\/point and the 3-\/point rule (x-\/h, x, x+h). Again the central point is not used.


\begin{DoxyTemplParams}{Template Parameters}
{\em Func} & A function type callable with a numeric type and returning the same. \\
\hline
{\em Tp} & The foating point type of the argument and stepsize.\\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}{Parameters}
{\em func} & The function to be differentated. \\
\hline
{\em x} & The location at which the derivative is required. \\
\hline
{\em h} & The stepsize.\\
\hline
\end{DoxyParams}
Compute the derivative using the 5-\/point rule (x-\/h, x-\/h/2, x, x+h/2, x+h). Note that the central point is not used. \[ f\textnormal{\textquotesingle}_3(x) = \frac{f(x + h) - f(x - h)}{2h} \] \[ f\textnormal{\textquotesingle}_5(x) = \frac{4}{3}\frac{f(x + h/2) - f(x - h/2)}{2h} - \frac{1}{3}f\textnormal{\textquotesingle}_3(x) \]

Compute the error using the difference between the 5-\/point and the 3-\/point rule (x-\/h, x, x+h). Again the central point is not used.


\begin{DoxyTemplParams}{Template Parameters}
{\em Func} & A function type callable with a numeric type and returning the same. \\
\hline
{\em Tp} & The foating point type of the argument and stepsize.\\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}{Parameters}
{\em func} & The function to be differentated. \\
\hline
{\em x} & The location at which the derivative is required. \\
\hline
{\em h} & The stepsize. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{differentiation_8h_a2fd096a92e6b977a98fd7d16a04dc8b4}\label{differentiation_8h_a2fd096a92e6b977a98fd7d16a04dc8b4}} 
\index{differentiation.h@{differentiation.h}!derivative\_forward@{derivative\_forward}}
\index{derivative\_forward@{derivative\_forward}!differentiation.h@{differentiation.h}}
\doxysubsubsection{\texorpdfstring{derivative\_forward()}{derivative\_forward()}}
{\footnotesize\ttfamily template$<$typename Func , typename Tp $>$ \\
\mbox{\hyperlink{structderivative__t}{derivative\+\_\+t}}$<$Tp$>$ derivative\+\_\+forward (\begin{DoxyParamCaption}\item[{Func}]{func,  }\item[{Tp}]{x,  }\item[{Tp}]{h }\end{DoxyParamCaption})}

Compute the derivative using the 4-\/point rule (x + h/4, x + h/2, x + 3h/4, x + h).

Compute the error using the difference between the 4-\/point and the 2-\/point rule (x + h/2, x+h).


\begin{DoxyTemplParams}{Template Parameters}
{\em Func} & A function type callable with a numeric type and returning the same. \\
\hline
{\em Tp} & The foating point type of the argument and stepsize.\\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}{Parameters}
{\em func} & The function to be differentated. \\
\hline
{\em x} & The location at which the derivative is required. \\
\hline
{\em h} & The stepsize.\\
\hline
\end{DoxyParams}
Compute the derivative using the 4-\/point rule (x + h/4, x + h/2, x + 3h/4, x + h). \[ f\textnormal{\textquotesingle}_2(x) = \frac{f(x + h) - f(x + h/2)}{h/2} \] \[ f\textnormal{\textquotesingle}_4(x) = \frac{22(f(x + h) - f(x + 3h/4)) - 62(f(x + 3h/4) - f(x + h/2)) + 52(f(x + h/2 - f(x + h/4))}{3h} \]

Compute the error using the difference between the 4-\/point and the 2-\/point rule (x + h/2, x+h).


\begin{DoxyTemplParams}{Template Parameters}
{\em Func} & A function type callable with a numeric type and returning the same. \\
\hline
{\em Tp} & The foating point type of the argument and stepsize.\\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}{Parameters}
{\em func} & The function to be differentated. \\
\hline
{\em x} & The location at which the derivative is required. \\
\hline
{\em h} & The stepsize. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{differentiation_8h_ad773ecd26f4d7a6754acecdc833639a2}\label{differentiation_8h_ad773ecd26f4d7a6754acecdc833639a2}} 
\index{differentiation.h@{differentiation.h}!derivative\_ridder@{derivative\_ridder}}
\index{derivative\_ridder@{derivative\_ridder}!differentiation.h@{differentiation.h}}
\doxysubsubsection{\texorpdfstring{derivative\_ridder()}{derivative\_ridder()}}
{\footnotesize\ttfamily template$<$typename Func , typename Tp $>$ \\
\mbox{\hyperlink{structderivative__t}{derivative\+\_\+t}}$<$Tp$>$ derivative\+\_\+ridder (\begin{DoxyParamCaption}\item[{Func}]{func,  }\item[{Tp}]{x,  }\item[{Tp}]{h }\end{DoxyParamCaption})}

Compute the derivative of a function func at a point x by Ridder\textquotesingle{}s method of polynomial extrapolation.

The value h is input as an estimated stepsize; it should not be small but rather it should be an interval over which the function changes substantially.


\begin{DoxyTemplParams}{Template Parameters}
{\em Func} & A function type callable with a numeric type and returning the same. \\
\hline
{\em Tp} & The foating point type of the argument and stepsize.\\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}{Parameters}
{\em func} & The function to be differentated. \\
\hline
{\em x} & The location at which the derivative is required. \\
\hline
{\em h} & The initial stepsize.\\
\hline
\end{DoxyParams}
Compute the derivative of a function func at a point x by Ridder\textquotesingle{}s method of polynomial extrapolation. \[ \]

The value h is input as an estimated stepsize; it should not be small but rather it should be an interval over which the function changes substantially.


\begin{DoxyTemplParams}{Template Parameters}
{\em Func} & A function type callable with a numeric type and returning the same. \\
\hline
{\em Tp} & The foating point type of the argument and stepsize.\\
\hline
\end{DoxyTemplParams}

\begin{DoxyParams}{Parameters}
{\em func} & The function to be differentated. \\
\hline
{\em x} & The location at which the derivative is required. \\
\hline
{\em h} & The initial stepsize. \\
\hline
\end{DoxyParams}
