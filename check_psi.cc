// { dg-options "-D__STDCPP_WANT_MATH_SPEC_FUNCS__" }
//
// Copyright (C) 2015 Free Software Foundation, Inc.
//
// This file is part of the GNU ISO C++ Library.  This library is free
// software; you can redistribute it and/or modify it under the
// terms of the GNU General Public License as published by the
// Free Software Foundation; either version 3, or (at your option)
// any later version.
//
// This library is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this library; see the file COPYING3.  If not see
// <http://www.gnu.org/licenses/>.

//  psi
//  Compare against values generated by the GNU Scientific Library.
//  The GSL can be found on the web: http://www.gnu.org/software/gsl/
#include <limits>
#include <cmath>
#if defined(__TEST_DEBUG)
#  include <iostream>
#  define VERIFY(A) \
  if (!(A)) \
    { \
      std::cout << "line " << __LINE__ \
	<< "  max_abs_frac = " << max_abs_frac \
	<< std::endl; \
    }
#else
#  include <testsuite_hooks.h>
#endif
#include <specfun_testcase.h>


// Test data.
const testcase_psi<double>
data001[401] =
{
  { -5.2446900613726646, -9.8750000000000000 },
  { -2.7916549229772443, -9.8249999999999993 },
  { -1.3482246241204852, -9.7750000000000004 },
  { -0.35794003782487671, -9.7249999999999996 },
  { 0.39516505774573196, -9.6750000000000007 },
  { 1.0141230802430035, -9.6250000000000000 },
  { 1.5562372242479885, -9.5749999999999993 },
  { 2.0582471421542348, -9.5250000000000004 },
  { 2.5477486919566195, -9.4749999999999996 },
  { 3.0497087325919336, -9.4250000000000007 },
  { 3.5917231146157280, -9.3750000000000000 },
  { 4.2105314755392094, -9.3249999999999993 },
  { 4.9634369876106987, -9.2750000000000004 },
  { 5.9534720386876554, -9.2249999999999996 },
  { 7.3966028133357780, -9.1750000000000007 },
  { 9.8492883937673632, -9.1250000000000000 },
  { 15.345284306459252, -9.0749999999999993 },
  { 42.172097754589515, -9.0250000000000004 },
  { -37.668599482625559, -8.9749999999999996 },
  { -10.841841285572098, -8.9250000000000007 },
  { -5.3459558841574770, -8.8750000000000000 },
  { -2.8934360934607066, -8.8249999999999993 },
  { -1.4505264144018164, -8.7750000000000004 },
  { -0.46076780132102213, -8.7249999999999996 },
  { 0.29180588461911672, -8.6750000000000007 },
  { 0.91022697634689886, -8.6250000000000000 },
  { 1.4517985819503387, -8.5749999999999993 },
  { 1.9532602655138149, -8.5250000000000004 },
  { 2.4422077948589940, -8.4749999999999996 },
  { 2.9436079368359644, -8.4250000000000007 },
  { 3.4850564479490611, -8.3750000000000000 },
  { 4.1032928696410860, -8.3249999999999993 },
  { 4.8556202760204012, -8.2750000000000004 },
  { 5.8450709546768138, -8.2249999999999996 },
  { 7.2876109877226973, -8.1750000000000007 },
  { 9.7396993526714688, -8.1250000000000000 },
  { 15.235091468993680, -8.0749999999999993 },
  { 42.061294430489724, -8.0250000000000004 },
  { -37.780020095438992, -7.9749999999999996 },
  { -10.953886103499070, -7.9249999999999998 },
  { -5.4586319404955068, -7.8750000000000000 },
  { -3.0067505410528161, -7.8250000000000002 },
  { -1.5644865283619316, -7.7750000000000004 },
  { -0.57538098183678166, -7.7249999999999996 },
  { 0.17653210940299324, -7.6749999999999998 },
  { 0.79428494736139132, -7.6250000000000000 },
  { 1.3351805061485769, -7.5750000000000002 },
  { 1.8359582127278908, -7.5250000000000004 },
  { 2.3242136945640079, -7.4749999999999996 },
  { 2.8249135748181722, -7.4249999999999998 },
  { 3.3656534628744335, -7.3750000000000000 },
  { 3.9831727495209495, -7.3250000000000002 },
  { 4.7347743545702494, -7.2750000000000004 },
  { 5.7234904075643520, -7.2249999999999996 },
  { 7.1652868287013316, -7.1749999999999998 },
  { 9.6166224295945444, -7.1250000000000000 },
  { 15.111252459705543, -7.0750000000000002 },
  { 41.936683838589353, -7.0250000000000004 },
  { -37.905411944968840, -6.9749999999999996 },
  { -11.080069068798760, -6.9249999999999998 },
  { -5.5856160674796378, -6.8750000000000000 },
  { -3.1345460682093673, -6.8250000000000002 },
  { -1.6931038917059835, -6.7750000000000004 },
  { -0.70483082002448394, -6.7249999999999996 },
  { 0.046238949793872219, -6.6749999999999998 },
  { 0.66313740637778462, -6.6250000000000000 },
  { 1.2031673048284448, -6.5750000000000002 },
  { 1.7030678472793852, -6.5250000000000004 },
  { 2.1904344303499612, -6.4749999999999996 },
  { 2.6902334401380372, -6.4249999999999998 },
  { 3.2300602425354503, -6.3750000000000000 },
  { 3.8466539781898912, -6.3250000000000002 },
  { 4.5973173098967095, -6.2750000000000004 },
  { 5.5850821030660809, -6.2249999999999996 },
  { 7.0259140064016785, -6.1749999999999998 },
  { 9.4762715524015597, -6.1250000000000000 },
  { 14.969909703521791, -6.0750000000000002 },
  { 41.794335084140890, -6.0250000000000004 },
  { -38.048781120596132, -5.9749999999999996 },
  { -11.224473400928730, -5.9249999999999998 },
  { -5.7310706129341851, -5.8750000000000000 },
  { -3.2810662147295142, -5.8250000000000002 },
  { -1.8407053677207448, -5.7750000000000004 },
  { -0.85352970478284917, -5.7249999999999996 },
  { -0.10357378428852515, -5.6749999999999998 },
  { 0.51219401015136912, -5.6250000000000000 },
  { 1.0510760500755929, -5.5750000000000002 },
  { 1.5498111422985421, -5.5250000000000004 },
  { 2.0359942759098066, -5.4749999999999996 },
  { 2.5345914167917334, -5.4249999999999998 },
  { 3.0731974974374108, -5.3750000000000000 },
  { 3.6885512113914722, -5.3250000000000002 },
  { 4.4379547600959119, -5.2750000000000004 },
  { 5.4244395327849553, -5.2249999999999996 },
  { 6.8639706865636203, -5.1749999999999998 },
  { 9.3130062462791088, -5.1250000000000000 },
  { 14.805300650023842, -5.0750000000000002 },
  { 41.628359980406394, -5.0250000000000004 },
  { -38.216145137332596, -4.9749999999999996 },
  { -11.393249772236754, -4.9249999999999998 },
  { -5.9012833788915975, -4.8750000000000000 },
  { -3.4527400344720056, -4.8250000000000002 },
  { -2.0138655408809312, -4.7750000000000004 },
  { -1.0282021938658192, -4.7249999999999996 },
  { -0.27978523803302680, -4.6749999999999998 },
  { 0.33441623237359086, -4.6250000000000000 },
  { 0.87170385276616913, -4.5750000000000002 },
  { 1.3688156671854250, -4.5250000000000004 },
  { 1.8533458740833164, -4.4749999999999996 },
  { 2.3502596195567156, -4.4249999999999998 },
  { 2.8871509858095035, -4.3750000000000000 },
  { 3.5007577841614319, -4.3250000000000002 },
  { 4.2483813003802711, -4.2750000000000004 },
  { 5.2330519729763560, -4.2249999999999996 },
  { 6.6707339715877740, -4.1749999999999998 },
  { 9.1178842950595538, -4.1250000000000000 },
  { 14.608256315048466, -4.0750000000000002 },
  { 41.429355005281948, -4.0250000000000004 },
  { -38.417150162458292, -3.9749999999999996 },
  { -11.596295457515952, -3.9249999999999998 },
  { -6.1064115840198046, -3.8750000000000000 },
  { -3.6599939204823690, -3.8250000000000002 },
  { -2.2232896246505662, -3.7750000000000004 },
  { -1.2398424055060320, -3.7249999999999996 },
  { -0.49368898134853567, -3.6749999999999998 },
  { 0.11820001615737419, -3.6250000000000000 },
  { 0.65312461779349118, -3.5750000000000002 },
  { 1.1478211920473034, -3.5250000000000004 },
  { 1.6298821869324780, -3.4749999999999996 },
  { 2.1242709189917433, -3.4249999999999998 },
  { 2.6585795572380744, -3.3750000000000000 },
  { 3.2695439113290616, -3.3250000000000002 },
  { 4.0144631717252999, -3.2750000000000004 },
  { 4.9963655824438105, -3.2249999999999996 },
  { 6.4312130135039389, -3.1749999999999998 },
  { 8.8754600526353080, -3.1250000000000000 },
  { 14.362857542042324, -3.0750000000000002 },
  { 41.180907800312944, -3.0250000000000004 },
  { -38.668722489502386, -2.9749999999999996 },
  { -11.851072527579653, -2.9249999999999998 },
  { -6.3644761001488401, -2.8750000000000000 },
  { -3.9214318289791033, -2.8250000000000002 },
  { -2.4881902869022232, -2.7750000000000004 },
  { -1.5082987813449589, -2.7249999999999996 },
  { -0.76579782488595116, -2.6749999999999998 },
  { -0.15766205280814360, -2.6250000000000000 },
  { 0.37340433807321116, -2.5750000000000002 },
  { 0.86413324878488873, -2.5250000000000004 },
  { 1.3421124027598184, -2.4749999999999996 },
  { 1.8323001160720320, -2.4249999999999998 },
  { 2.3622832609417772, -2.3750000000000000 },
  { 2.9687920316298126, -2.3250000000000002 },
  { 3.7091196602749177, -2.2750000000000004 },
  { 4.6862880630639641, -2.2249999999999996 },
  { 6.1162523835826788, -2.1749999999999998 },
  { 8.5554600526353077, -2.1250000000000000 },
  { 14.037654290009847, -2.0750000000000002 },
  { 40.850329287915727, -2.0250000000000004 },
  { -39.004856943283741, -1.9749999999999996 },
  { -12.192952869460060, -1.9249999999999998 },
  { -6.7123021871053794, -1.8750000000000000 },
  { -4.2754141298640329, -1.8249999999999993 },
  { -2.8485506472625848, -1.7750000000000004 },
  { -1.8752712584091822, -1.7249999999999996 },
  { -1.1396296005868987, -1.6750000000000007 },
  { -0.53861443376052387, -1.6250000000000000 },
  { -0.014945176489885331, -1.5749999999999993 },
  { 0.46809364482449206, -1.5250000000000004 },
  { 0.93807199871941283, -1.4749999999999996 },
  { 1.4199289820514038, -1.4250000000000007 },
  { 1.9412306293628270, -1.3750000000000000 },
  { 2.5386845047481028, -1.3249999999999993 },
  { 3.2695592207144775, -1.2750000000000004 },
  { 4.2368498608167693, -1.2249999999999996 },
  { 5.6564822686401168, -1.1750000000000007 },
  { 8.0848718173411953, -1.1250000000000000 },
  { 13.555726579166612, -1.0749999999999993 },
  { 40.356502127421891, -1.0250000000000004 },
  { -39.511186057207787, -0.97499999999999964 },
  { -12.712433388940740, -0.92500000000000071 },
  { -7.2456355204387126, -0.87500000000000000 },
  { -4.8233593353434845, -0.82499999999999929 },
  { -3.4119309289527253, -0.77500000000000036 },
  { -2.4549814033367188, -0.72499999999999964 },
  { -1.7366445259600325, -0.67500000000000071 },
  { -1.1539990491451393, -0.62500000000000000 },
  { -0.64986581141052047, -0.57499999999999929 },
  { -0.18764406009354032, -0.52500000000000036 },
  { 0.26010589702449721, -0.47499999999999964 },
  { 0.71817459608649203, -0.42500000000000071 },
  { 1.2139579020900999, -0.37500000000000000 },
  { 1.7839675236160268, -0.32499999999999929 },
  { 2.4852454952242824, -0.27500000000000036 },
  { 3.4205233302045248, -0.22499999999999964 },
  { 4.8054184388528824, -0.17500000000000071 },
  { 7.1959829284523051, -0.12500000000000000 },
  { 12.625494021027077, -0.074999999999999289 },
  { 39.380892371324329, -0.025000000000000355 },
  { -40.536827082848816, 0.025000000000000355 },
  { -13.793514470021821, 0.074999999999999289 },
  { -8.3884926632958550, 0.12500000000000000 },
  { -6.0354805474646982, 0.17500000000000071 },
  { -4.7022535095978855, 0.22499999999999964 },
  { -3.8342917481643055, 0.27500000000000036 },
  { -3.2181260074415126, 0.32499999999999929 },
  { -2.7539990491451394, 0.37500000000000000 },
  { -2.3889962461931313, 0.42500000000000071 },
  { -2.0924059648554438, 0.47499999999999964 },
  { -1.8451572608702413, 0.52500000000000036 },
  { -1.6347665803840923, 0.57499999999999929 },
  { -1.4527087645765666, 0.62500000000000000 },
  { -1.2929555533070569, 0.67500000000000071 },
  { -1.1511181411393496, 0.72499999999999964 },
  { -1.0239211142399269, 0.77500000000000036 },
  { -0.90886727543280876, 0.82499999999999929 },
  { -0.80401707154769531, 0.87500000000000000 },
  { -0.70783931230638220, 0.92500000000000071 },
  { -0.61910762867510005, 0.97499999999999964 },
  { -0.53682708284938796, 1.0250000000000004 },
  { -0.46018113668836080, 1.0749999999999993 },
  { -0.38849266329585491, 1.1250000000000000 },
  { -0.32119483317900716, 1.1750000000000007 },
  { -0.25780906515343410, 1.2249999999999996 },
  { -0.19792811180067360, 1.2750000000000004 },
  { -0.14120293051842869, 1.3249999999999993 },
  { -0.087332382478472886, 1.3750000000000000 },
  { -0.036055069722546990, 1.4250000000000007 },
  { 0.012857193039294636, 1.4749999999999996 },
  { 0.059604643891662243, 1.5250000000000004 },
  { 0.10436385439851856, 1.5749999999999993 },
  { 0.14729123542343345, 1.6250000000000000 },
  { 0.18852592817442290, 1.6750000000000007 },
  { 0.22819220368823728, 1.7249999999999996 },
  { 0.26640146640523360, 1.7750000000000004 },
  { 0.30325393668840450, 1.8249999999999993 },
  { 0.33884007130944749, 1.8750000000000000 },
  { 0.37324176877469806, 1.9250000000000007 },
  { 0.40653339696592594, 1.9749999999999996 },
  { 0.43878267324817266, 2.0250000000000004 },
  { 0.47005142145117462, 2.0749999999999993 },
  { 0.50039622559303387, 2.1250000000000000 },
  { 0.52986899660822639, 2.1750000000000007 },
  { 0.55851746545881109, 2.2249999999999996 },
  { 0.58638561368952224, 2.2750000000000004 },
  { 0.61351405061364717, 2.3249999999999993 },
  { 0.63994034479425421, 2.3750000000000000 },
  { 0.66569931624236489, 2.4250000000000007 },
  { 0.69082329473420989, 2.4749999999999996 },
  { 0.71534234880969494, 2.5250000000000004 },
  { 0.73928448931915380, 2.5749999999999993 },
  { 0.76267585080804878, 2.6250000000000000 },
  { 0.78554085354755698, 2.6750000000000007 },
  { 0.80790234861577348, 2.7249999999999996 },
  { 0.82978174809537431, 2.7750000000000004 },
  { 0.85119914216785675, 2.8249999999999993 },
  { 0.87217340464278070, 2.8750000000000000 },
  { 0.89272228825521727, 2.9250000000000007 },
  { 0.91286251088997650, 2.9749999999999996 },
  { 0.93260983374199968, 3.0250000000000004 },
  { 0.95197913229454856, 3.0749999999999993 },
  { 0.97098446088715162, 3.1250000000000000 },
  { 0.98963911155075501, 3.1750000000000007 },
  { 1.0079556677060022, 3.2249999999999996 },
  { 1.0259460532499618, 3.2750000000000004 },
  { 1.0436215774953679, 3.3249999999999993 },
  { 1.0609929763732018, 3.3750000000000000 },
  { 1.0780704502629834, 3.4250000000000007 },
  { 1.0948636987746143, 3.4749999999999996 },
  { 1.1113819527700910, 3.5250000000000004 },
  { 1.1276340038822605, 3.5749999999999993 },
  { 1.1436282317604300, 3.6250000000000000 },
  { 1.1593726292484916, 3.6750000000000007 },
  { 1.1748748256799939, 3.7249999999999996 },
  { 1.1901421084557346, 3.7750000000000004 },
  { 1.2051814430528129, 3.8249999999999993 },
  { 1.2199994915993027, 3.8750000000000000 },
  { 1.2346026301355593, 3.9250000000000007 },
  { 1.2489969646714894, 3.9749999999999996 },
  { 1.2631883461386941, 4.0250000000000004 },
  { 1.2771823843270691, 4.0749999999999993 },
  { 1.2909844608871517, 4.1250000000000000 },
  { 1.3045997414720147, 4.1750000000000007 },
  { 1.3180331870858473, 4.2249999999999996 },
  { 1.3312895647003435, 4.2750000000000004 },
  { 1.3443734571946160, 4.3249999999999993 },
  { 1.3572892726694981, 4.3750000000000000 },
  { 1.3700412531826913, 4.4250000000000007 },
  { 1.3826334829472762, 4.4749999999999996 },
  { 1.3950698960325023, 4.5250000000000004 },
  { 1.4073542836025406, 4.5749999999999993 },
  { 1.4194903007259472, 4.6250000000000000 },
  { 1.4314814727859067, 4.6750000000000007 },
  { 1.4433312015189204, 4.7249999999999996 },
  { 1.4550427707073905, 4.7750000000000004 },
  { 1.4666193515495449, 4.8249999999999993 },
  { 1.4780640077283349, 4.8750000000000000 },
  { 1.4893797001992533, 4.9250000000000007 },
  { 1.5005692917155147, 4.9749999999999996 },
  { 1.5116355511076380, 5.0250000000000004 },
  { 1.5225811573332040, 5.0749999999999993 },
  { 1.5334087033113943, 5.1250000000000000 },
  { 1.5441206995558472, 5.1750000000000007 },
  { 1.5547195776183917, 5.2249999999999996 },
  { 1.5652076933553141, 5.2750000000000004 },
  { 1.5755873300269863, 5.3249999999999993 },
  { 1.5858607012409267, 5.3750000000000000 },
  { 1.5960299537476632, 5.4250000000000007 },
  { 1.6060971700981144, 5.4749999999999996 },
  { 1.6160643711706240, 5.5250000000000004 },
  { 1.6259335185752182, 5.5749999999999993 },
  { 1.6357065169421636, 5.6250000000000000 },
  { 1.6453852161014144, 5.6750000000000007 },
  { 1.6549714131591318, 5.7249999999999996 },
  { 1.6644668544770238, 5.7750000000000004 },
  { 1.6738732375599077, 5.8249999999999993 },
  { 1.6831922128565402, 5.8750000000000000 },
  { 1.6924253854784412, 5.9250000000000007 },
  { 1.7015743168411428, 5.9749999999999996 },
  { 1.7106405262320163, 6.0250000000000004 },
  { 1.7196254923085734, 6.0749999999999993 },
  { 1.7285306545309065, 6.1250000000000000 },
  { 1.7373574145316923, 6.1750000000000007 },
  { 1.7461071374270045, 6.2250000000000014 },
  { 1.7547811530709538, 6.2749999999999986 },
  { 1.7633807572570330, 6.3249999999999993 },
  { 1.7719072128688336, 6.3750000000000000 },
  { 1.7803617509826863, 6.4250000000000007 },
  { 1.7887455719245986, 6.4750000000000014 },
  { 1.7970598462837455, 6.5249999999999986 },
  { 1.8053057158846351, 6.5749999999999993 },
  { 1.8134842947199412, 6.6250000000000000 },
  { 1.8215966698459078, 6.6750000000000007 },
  { 1.8296439022421014, 6.7250000000000014 },
  { 1.8376270276371964, 6.7749999999999986 },
  { 1.8455470573023967, 6.8249999999999993 },
  { 1.8534049788139868, 6.8750000000000000 },
  { 1.8612017567864581, 6.9250000000000007 },
  { 1.8689383335775447, 6.9750000000000014 },
  { 1.8766156299664556, 7.0249999999999986 },
  { 1.8842345458065157, 7.0749999999999993 },
  { 1.8917959606533554, 7.1250000000000000 },
  { 1.8993007343697490, 7.1750000000000007 },
  { 1.9067497077081288, 7.2250000000000014 },
  { 1.9141437028717503, 7.2749999999999986 },
  { 1.9214835240554520, 7.3249999999999993 },
  { 1.9287699579668727, 7.3750000000000000 },
  { 1.9360037743289897, 7.4250000000000007 },
  { 1.9431857263647527, 7.4750000000000014 },
  { 1.9503165512645884, 7.5249999999999986 },
  { 1.9573969706374867, 7.5749999999999993 },
  { 1.9644276909463558, 7.6250000000000000 },
  { 1.9714094039283048, 7.6750000000000007 },
  { 1.9783427870004655, 7.7250000000000014 },
  { 1.9852285036519568, 7.7749999999999986 },
  { 1.9920672038225431, 7.8249999999999993 },
  { 1.9988595242685321, 7.8750000000000000 },
  { 2.0056060889164220, 7.9250000000000007 },
  { 2.0123075092047848, 7.9750000000000014 },
  { 2.0189643844148542, 8.0249999999999986 },
  { 2.0255773019902614, 8.0749999999999993 },
  { 2.0321468378463372, 8.1250000000000000 },
  { 2.0386735566694005, 8.1750000000000007 },
  { 2.0451580122063984, 8.2250000000000014 },
  { 2.0516007475452902, 8.2749999999999986 },
  { 2.0580022953865100, 8.3249999999999993 },
  { 2.0643631783058556, 8.3750000000000000 },
  { 2.0706839090091242, 8.4250000000000007 },
  { 2.0769649905787997, 8.4750000000000014 },
  { 2.0832069167130935, 8.5249999999999986 },
  { 2.0894101719576188, 8.5749999999999993 },
  { 2.0955752319299630, 8.6250000000000000 },
  { 2.1017025635374251, 8.6750000000000007 },
  { 2.1077926251881682, 8.7250000000000014 },
  { 2.1138458669960083, 8.7749999999999986 },
  { 2.1198627309790923, 8.8249999999999993 },
  { 2.1258436512526595, 8.8750000000000000 },
  { 2.1317890542161066, 8.9250000000000007 },
  { 2.1376993587345652, 8.9750000000000014 },
  { 2.1435749763151657, 9.0249999999999986 },
  { 2.1494163112781868, 9.0749999999999993 },
  { 2.1552237609232612, 9.1250000000000000 },
  { 2.1609977156908071, 9.1750000000000007 },
  { 2.1667385593188606, 9.2250000000000014 },
  { 2.1724466689954411, 9.2749999999999986 },
  { 2.1781224155066301, 9.3249999999999993 },
  { 2.1837661633804828, 9.3750000000000000 },
  { 2.1893782710269285, 9.4250000000000007 },
  { 2.1949590908737848, 9.4750000000000014 },
  { 2.2005089694990172, 9.5249999999999986 },
  { 2.2060282477593680, 9.5749999999999993 },
  { 2.2115172609154699, 9.6250000000000000 },
  { 2.2169763387535637, 9.6750000000000007 },
  { 2.2224058057039273, 9.7250000000000014 },
  { 2.2278059809561221, 9.7749999999999986 },
  { 2.2331771785711609, 9.8249999999999993 },
  { 2.2385197075906875, 9.8750000000000000 },
  { 2.2438338721432776, 9.9250000000000007 },
  { 2.2491199715479362, 9.9750000000000014 },
  { 2.2543783004148890, 10.024999999999999 },
  { 2.2596091487437522, 10.074999999999999 },
  { 2.2648128020191511, 10.125000000000000 },
};
const double toler001 = 0.050000000000000003;
template<typename Tp, unsigned int Num>
  void
  test(const testcase_psi<Tp> (&data)[Num], Tp toler)
  {
    bool test __attribute__((unused)) = true;
    const Tp eps = std::numeric_limits<Tp>::epsilon();
    Tp max_abs_diff = -Tp(1);
    Tp max_abs_frac = -Tp(1);
    unsigned int num_datum = Num;
    for (unsigned int i = 0; i < num_datum; ++i)
      {
	const Tp f = __gnu_cxx::psi(data[i].x);
	const Tp f0 = data[i].f0;
	const Tp diff = f - f0;
	if (std::abs(diff) > max_abs_diff)
	  max_abs_diff = std::abs(diff);
	if (std::abs(f0) > Tp(10) * eps
	 && std::abs(f) > Tp(10) * eps)
	  {
	    const Tp frac = diff / f0;
	    if (std::abs(frac) > max_abs_frac)
	      max_abs_frac = std::abs(frac);
	  }
      }
    VERIFY(max_abs_frac < toler);
  }

int
main()
{
  test(data001, toler001);
  return 0;
}
