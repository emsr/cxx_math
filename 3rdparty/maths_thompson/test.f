CPC TEST OF BESSCC43
      IMPLICIT REAL*8 (A-H,O-Z)
      COMPLEX*16 Z,FI(201),FK(201),FIP(201),FKP(201)
      INTEGER LDISP(8)
      COMMON      /BSTEED/ ACCUR,NFP,NPQ(2),KASE
      CHARACTER*20 NOTE
      DATA ZERO,HALF,ONE / 0D+0,0.5D+0,1D+0 /
      DATA LDISP / 1,2,4,11,31,101,301,1001 /
C
      WRITE(6,1000)
C
      ACC = 1D-3
      R = 0.99
      DO 5 I=1,20000
      IF(ONE+ACC.EQ.ONE) GO TO 6
    5 ACC = ACC * R
      WRITE(6,*) 'ACC =',ACC,' NOT YET NEAR MACHINE PRECISION'
      GO TO 10
    6 ACC = ACC / R
      WRITE(6,1060) ACC
C
   10 READ(5,*,END=40) Z,XNUMIN,NL,MODE,NOTE
      IF(NL.LE.0) GO TO 40
      IFAIL = 1
      WRITE(6,1010) Z,XNUMIN,NL,MODE,NOTE
C
      CALL BESSCC(Z,XNUMIN,NL,FI,FK,FIP,FKP,MODE,ACC,IFAIL)
C
      WRITE(6,1020) IFAIL,ACCUR,NFP,NPQ,KASE
      IF(IFAIL.LT.0) GO TO 30
      DO 20 I=1,8
      L = LDISP(I)
      IF(L.GT.NL-IFAIL) GO TO 20
         XNU = XNUMIN + L - 1
      WRITE(6,1030) XNU,FI(L),FK(L)
      IF(ABS(MODE).EQ.1)WRITE(6,1040)    FIP(L),FKP(L)
   20 CONTINUE
   30 CONTINUE
      GO TO 10
   40 STOP
C
 1000 FORMAT('1TEST OF THE CONTINUED FRACTION  BESSEL ROUTINES'/)
 1010 FORMAT(/'0Z =',F12.4,F9.4,', NU(MIN) =',F12.7,'  NL =',I4,
     X        '  MODE = ',I3,8X,A20)
 1020 FORMAT(' BESSCC  :: IFAIL =',I4,'  ACCUR =',1P,E10.1,
     X                '  ITS =',3I6,', KASE =',I2/)
 1030 FORMAT(' NU =',F8.3,' :: I =',1P,2D18.11,',  K = ',2D18.11)
 1040 FORMAT(16X,' I''=',1P,2D18.11,',  K'' =',2D18.11)
 1060 FORMAT(//' SMALLEST ACC ALLOWED ON THIS MACHINE =',1P,E10.2)
      END
