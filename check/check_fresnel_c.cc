// { dg-do run { target c++11 } }
// { dg-options "-D__STDCPP_WANT_MATH_SPEC_FUNCS__" }
//
// Copyright (C) 2016-2017 Free Software Foundation, Inc.
//
// This file is part of the GNU ISO C++ Library.  This library is free
// software; you can redistribute it and/or modify it under the
// terms of the GNU General Public License as published by the
// Free Software Foundation; either version 3, or (at your option)
// any later version.
//
// This library is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this library; see the file COPYING3.  If not see
// <http://www.gnu.org/licenses/>.

//  fresnel_c

//  Compare against values generated by the GNU Scientific Library.
//  The GSL can be found on the web: http://www.gnu.org/software/gsl/
#include <limits>
#include <cmath>
#if defined(__TEST_DEBUG)
#  include <iostream>
#  define VERIFY(A) \
  if (!(A)) \
    { \
      std::cout << "line " << __LINE__ \
	<< "  max_abs_frac = " << max_abs_frac \
	<< std::endl; \
    }
#else
#  include <testsuite_hooks.h>
#endif
#include <specfun_testcase.h>

// Test data.
// max(|f - f_GSL|): 1.9984014443252818e-15 at index 13
// max(|f - f_GSL| / |f_GSL|): 3.9881066375624449e-15
// mean(f - f_GSL): -6.2796989830360419e-18
// variance(f - f_GSL): 9.5931788624576488e-36
// stddev(f - f_GSL): 3.0972857250272615e-18
const testcase_fresnel_c<double>
data001[400] =
{
  { -0.50023839013188998, -19.899999999999999, 0.0 },
  { -0.50099640758066721, -19.800000000000001, 0.0 },
  { -0.50226353783109678, -19.699999999999999, 0.0 },
  { -0.50402575653177129, -19.600000000000001, 0.0 },
  { -0.50623412768912091, -19.500000000000000, 0.0 },
  { -0.50877996382009405, -19.399999999999999, 0.0 },
  { -0.51146736280128946, -19.300000000000001, 0.0 },
  { -0.51399010696333991, -19.199999999999999, 0.0 },
  { -0.51592439822004366, -19.100000000000001, 0.0 },
  { -0.51675311283005532, -19.000000000000000, 0.0 },
  { -0.51593859694716993, -18.899999999999999, 0.0 },
  { -0.51305553802784631, -18.800000000000001, 0.0 },
  { -0.50797873688884065, -18.699999999999999, 0.0 },
  { -0.50109027313941557, -18.600000000000001, 0.0 },
  { -0.49343037308486531, -18.500000000000000, 0.0 },
  { -0.48668094715993498, -18.399999999999999, 0.0 },
  { -0.48286791414803398, -18.300000000000001, 0.0 },
  { -0.48373248189252743, -18.199999999999999, 0.0 },
  { -0.48987390239407780, -18.100000000000001, 0.0 },
  { -0.49998262693469964, -18.000000000000000, 0.0 },
  { -0.51066291912679762, -17.899999999999999, 0.0 },
  { -0.51731624358389805, -17.800000000000001, 0.0 },
  { -0.51615776547019099, -17.699999999999999, 0.0 },
  { -0.50667508150034346, -17.600000000000001, 0.0 },
  { -0.49305680746541819, -17.500000000000000, 0.0 },
  { -0.48299811079987987, -17.399999999999999, 0.0 },
  { -0.48346826478202071, -17.300000000000001, 0.0 },
  { -0.49537837816356955, -17.199999999999999, 0.0 },
  { -0.51116034650988751, -17.100000000000001, 0.0 },
  { -0.51872404281097373, -17.000000000000000, 0.0 },
  { -0.51084730239743092, -16.899999999999999, 0.0 },
  { -0.49304503191814092, -16.800000000000001, 0.0 },
  { -0.48122716459814424, -16.699999999999999, 0.0 },
  { -0.48776018968221224, -16.600000000000001, 0.0 },
  { -0.50736167237605390, -16.500000000000000, 0.0 },
  { -0.51936931621446303, -16.399999999999999, 0.0 },
  { -0.50915847008368198, -16.300000000000001, 0.0 },
  { -0.48749382753788034, -16.199999999999999, 0.0 },
  { -0.48128735577455528, -16.100000000000001, 0.0 },
  { -0.49997526395650010, -16.000000000000000, 0.0 },
  { -0.51912698592690043, -15.899999999999999, 0.0 },
  { -0.51081650712718440, -15.800000000000001, 0.0 },
  { -0.48590957756653469, -15.699999999999999, 0.0 },
  { -0.48275771612353113, -15.600000000000000, 0.0 },
  { -0.50783365540525172, -15.500000000000000, 0.0 },
  { -0.52002689440795713, -15.399999999999999, 0.0 },
  { -0.49709663357908168, -15.300000000000001, 0.0 },
  { -0.47909819071930937, -15.199999999999999, 0.0 },
  { -0.50030168617863524, -15.100000000000000, 0.0 },
  { -0.52122053167437343, -15.000000000000000, 0.0 },
  { -0.49969507028487931, -14.899999999999999, 0.0 },
  { -0.47853318879141155, -14.800000000000001, 0.0 },
  { -0.50301944026109247, -14.699999999999999, 0.0 },
  { -0.52112505061981096, -14.600000000000000, 0.0 },
  { -0.49162993982669234, -14.500000000000000, 0.0 },
  { -0.48131820590404528, -14.399999999999999, 0.0 },
  { -0.51546562986269784, -14.300000000000001, 0.0 },
  { -0.51204098153903110, -14.199999999999999, 0.0 },
  { -0.47843360440911598, -14.100000000000000, 0.0 },
  { -0.49996307683096536, -14.000000000000000, 0.0 },
  { -0.52167739061099583, -13.899999999999999, 0.0 },
  { -0.48532704835825791, -13.800000000000001, 0.0 },
  { -0.48909325067276260, -13.699999999999999, 0.0 },
  { -0.52335621741310301, -13.600000000000000, 0.0 },
  { -0.49101502211761572, -13.500000000000000, 0.0 },
  { -0.48482602942492592, -13.399999999999999, 0.0 },
  { -0.52356906141782866, -13.300000000000001, 0.0 },
  { -0.49116394923384654, -13.199999999999999, 0.0 },
  { -0.48599152742744517, -13.100000000000000, 0.0 },
  { -0.52448511530435837, -13.000000000000000, 0.0 },
  { -0.48522242457763337, -12.899999999999999, 0.0 },
  { -0.49376886669639958, -12.800000000000001, 0.0 },
  { -0.52252945403720641, -12.699999999999999, 0.0 },
  { -0.47653027345084903, -12.600000000000000, 0.0 },
  { -0.50969690766970033, -12.500000000000000, 0.0 },
  { -0.50949909848663488, -12.399999999999999, 0.0 },
  { -0.47673643299215079, -12.300000000000001, 0.0 },
  { -0.52525705613894846, -12.199999999999999, 0.0 },
  { -0.48425094119563444, -12.100000000000000, 0.0 },
  { -0.49994136935201117, -12.000000000000000, 0.0 },
  { -0.51542961511131036, -11.900000000000000, 0.0 },
  { -0.47489658800882573, -11.799999999999999, 0.0 },
  { -0.52678954755926322, -11.699999999999999, 0.0 },
  { -0.47889845363079658, -11.600000000000000, 0.0 },
  { -0.51053061299658087, -11.500000000000000, 0.0 },
  { -0.50182144813012231, -11.400000000000000, 0.0 },
  { -0.48675707020411635, -11.299999999999999, 0.0 },
  { -0.52194393395003857, -11.199999999999999, 0.0 },
  { -0.47284606849031702, -11.100000000000000, 0.0 },
  { -0.52893666175579646, -11.000000000000000, 0.0 },
  { -0.47211182702492455, -10.900000000000000, 0.0 },
  { -0.52484134447409303, -10.799999999999999, 0.0 },
  { -0.47935744532442048, -10.699999999999999, 0.0 },
  { -0.51601826184087052, -10.600000000000000, 0.0 },
  { -0.48848000730270952, -10.500000000000000, 0.0 },
  { -0.50752415099884673, -10.399999999999999, 0.0 },
  { -0.49573750967047830, -10.299999999999999, 0.0 },
  { -0.50186416397596556, -10.199999999999999, 0.0 },
  { -0.49960330016608129, -10.100000000000000, 0.0 },
  { -0.49989869420551575, -10.000000000000000, 0.0 },
  { -0.49959937948871935, -9.8999999999999986, 0.0 },
  { -0.50193198474001821, -9.7999999999999989, 0.0 },
  { -0.49548631053139142, -9.6999999999999993, 0.0 },
  { -0.50813468155278363, -9.5999999999999996, 0.0 },
  { -0.48728733102656768, -9.5000000000000000, 0.0 },
  { -0.51804088703209483, -9.3999999999999986, 0.0 },
  { -0.47627249167238339, -9.2999999999999989, 0.0 },
  { -0.52914187331455542, -9.1999999999999993, 0.0 },
  { -0.46660822007983471, -9.0999999999999996, 0.0 },
  { -0.53536612746811985, -9.0000000000000000, 0.0 },
  { -0.46611820459609971, -8.8999999999999986, 0.0 },
  { -0.52796401615121291, -8.7999999999999989, 0.0 },
  { -0.48274465367208957, -8.6999999999999993, 0.0 },
  { -0.50248286002240272, -8.5999999999999996, 0.0 },
  { -0.51417759858373324, -8.5000000000000000, 0.0 },
  { -0.47091285899291474, -8.3999999999999986, 0.0 },
  { -0.53774664841866138, -8.2999999999999989, 0.0 },
  { -0.46384247668932699, -8.1999999999999993, 0.0 },
  { -0.52275061255785638, -8.0999999999999996, 0.0 },
  { -0.49980218037719698, -8.0000000000000000, 0.0 },
  { -0.47597379384841326, -7.8999999999999986, 0.0 },
  { -0.53947055265520294, -7.7999999999999989, 0.0 },
  { -0.46278209682263205, -7.6999999999999993, 0.0 },
  { -0.51563121965150938, -7.5999999999999996, 0.0 },
  { -0.51601825015233616, -7.5000000000000000, 0.0 },
  { -0.46010185207948123, -7.3999999999999986, 0.0 },
  { -0.53926801565846294, -7.2999999999999989, 0.0 },
  { -0.48874395365161799, -7.1999999999999993, 0.0 },
  { -0.47331119669659066, -7.0999999999999996, 0.0 },
  { -0.54546709254696979, -7.0000000000000000, 0.0 },
  { -0.47322531435151211, -6.8999999999999986, 0.0 },
  { -0.48306982803367005, -6.7999999999999989, 0.0 },
  { -0.54673657485136962, -6.6999999999999993, 0.0 },
  { -0.46899140771179332, -6.5999999999999996, 0.0 },
  { -0.48160345989096404, -6.5000000000000000, 0.0 },
  { -0.54960455570382416, -6.3999999999999986, 0.0 },
  { -0.47600445535306690, -6.2999999999999989, 0.0 },
  { -0.46760840976352597, -6.1999999999999993, 0.0 },
  { -0.54950220126396554, -6.0999999999999996, 0.0 },
  { -0.49953146785550101, -6.0000000000000000, 0.0 },
  { -0.44859195316983064, -5.8999999999999986, 0.0 },
  { -0.52983671597522963, -5.7999999999999989, 0.0 },
  { -0.53845895660668874, -5.6999999999999993, 0.0 },
  { -0.45171362460101588, -5.5999999999999996, 0.0 },
  { -0.47842141492531443, -5.5000000000000000, 0.0 },
  { -0.55723378101789123, -5.3999999999999986, 0.0 },
  { -0.50778657415526851, -5.2999999999999989, 0.0 },
  { -0.43888747422774221, -5.1999999999999993, 0.0 },
  { -0.49978210997689443, -5.0999999999999996, 0.0 },
  { -0.56363118870401219, -5.0000000000000000, 0.0 },
  { -0.50016096751230166, -4.8999999999999986, 0.0 },
  { -0.43379658162299595, -4.7999999999999989, 0.0 },
  { -0.49142649060102650, -4.6999999999999993, 0.0 },
  { -0.56723668228574775, -4.5999999999999996, 0.0 },
  { -0.52602591505353857, -4.5000000000000000, 0.0 },
  { -0.43833294083767815, -4.3999999999999986, 0.0 },
  { -0.44944117102490982, -4.2999999999999989, 0.0 },
  { -0.54171920316341604, -4.1999999999999993, 0.0 },
  { -0.57369563145120528, -4.0999999999999996, 0.0 },
  { -0.49842603303817756, -4.0000000000000000, 0.0 },
  { -0.42233271026093289, -3.8999999999999986, 0.0 },
  { -0.44809494701281916, -3.8000000000000007, 0.0 },
  { -0.54194566215448847, -3.6999999999999993, 0.0 },
  { -0.58795325967341550, -3.5999999999999979, 0.0 },
  { -0.53257243502800067, -3.5000000000000000, 0.0 },
  { -0.43849170336380161, -3.3999999999999986, 0.0 },
  { -0.40569440370625831, -3.3000000000000007, 0.0 },
  { -0.46632034695203833, -3.1999999999999993, 0.0 },
  { -0.56159390251135821, -3.0999999999999979, 0.0 },
  { -0.60572078929768569, -3.0000000000000000, 0.0 },
  { -0.56237645022582272, -2.8999999999999986, 0.0 },
  { -0.46749165169890666, -2.8000000000000007, 0.0 },
  { -0.39249396985274765, -2.6999999999999993, 0.0 },
  { -0.38893749619196982, -2.5999999999999979, 0.0 },
  { -0.45741300964177700, -2.5000000000000000, 0.0 },
  { -0.55496140585642950, -2.3999999999999986, 0.0 },
  { -0.62656170979195180, -2.3000000000000007, 0.0 },
  { -0.63628604490331941, -2.1999999999999993, 0.0 },
  { -0.58156413506083227, -2.0999999999999979, 0.0 },
  { -0.48825340607534073, -2.0000000000000000, 0.0 },
  { -0.39447053489152167, -1.8999999999999986, 0.0 },
  { -0.33363292722155730, -1.8000000000000007, 0.0 },
  { -0.32382687600390037, -1.6999999999999993, 0.0 },
  { -0.36546168344048913, -1.5999999999999979, 0.0 },
  { -0.44526117603982168, -1.5000000000000000, 0.0 },
  { -0.54309578354625776, -1.3999999999999986, 0.0 },
  { -0.63855045472702843, -1.3000000000000007, 0.0 },
  { -0.71543772292307373, -1.1999999999999993, 0.0 },
  { -0.76380666606201264, -1.0999999999999979, 0.0 },
  { -0.77989340037682309, -1.0000000000000000, 0.0 },
  { -0.76482302127332602, -0.89999999999999858, 0.0 },
  { -0.72284417189635464, -0.79999999999999716, 0.0 },
  { -0.65965235190450999, -0.69999999999999929, 0.0 },
  { -0.58109544699165050, -0.59999999999999787, 0.0 },
  { -0.49234422587144655, -0.50000000000000000, 0.0 },
  { -0.39748075917235803, -0.39999999999999858, 0.0 },
  { -0.29940097605204447, -0.29999999999999716, 0.0 },
  { -0.19992105759445239, -0.19999999999999929, 0.0 },
  { -0.099997532627082941, -0.099999999999997868, 0.0 },
  { 0.0000000000000000, 0.0000000000000000, 0.0 },
  { 0.099997532627086452, 0.10000000000000142, 0.0 },
  { 0.19992105759445594, 0.20000000000000284, 0.0 },
  { 0.29940097605204785, 0.30000000000000071, 0.0 },
  { 0.39748075917236164, 0.40000000000000213, 0.0 },
  { 0.49234422587144655, 0.50000000000000000, 0.0 },
  { 0.58109544699165350, 0.60000000000000142, 0.0 },
  { 0.65965235190451255, 0.70000000000000284, 0.0 },
  { 0.72284417189635652, 0.80000000000000071, 0.0 },
  { 0.76482302127332702, 0.90000000000000213, 0.0 },
  { 0.77989340037682309, 1.0000000000000000, 0.0 },
  { 0.76380666606201142, 1.1000000000000014, 0.0 },
  { 0.71543772292307117, 1.2000000000000028, 0.0 },
  { 0.63855045472702843, 1.3000000000000007, 0.0 },
  { 0.54309578354625432, 1.4000000000000021, 0.0 },
  { 0.44526117603982168, 1.5000000000000000, 0.0 },
  { 0.36546168344048685, 1.6000000000000014, 0.0 },
  { 0.32382687600389970, 1.7000000000000028, 0.0 },
  { 0.33363292722155730, 1.8000000000000007, 0.0 },
  { 0.39447053489152467, 1.9000000000000021, 0.0 },
  { 0.48825340607534073, 2.0000000000000000, 0.0 },
  { 0.58156413506083504, 2.1000000000000014, 0.0 },
  { 0.63628604490332019, 2.2000000000000028, 0.0 },
  { 0.62656170979195180, 2.3000000000000007, 0.0 },
  { 0.55496140585642617, 2.4000000000000021, 0.0 },
  { 0.45741300964177700, 2.5000000000000000, 0.0 },
  { 0.38893749619196849, 2.6000000000000014, 0.0 },
  { 0.39249396985274909, 2.7000000000000028, 0.0 },
  { 0.46749165169890666, 2.8000000000000007, 0.0 },
  { 0.56237645022582572, 2.9000000000000021, 0.0 },
  { 0.60572078929768569, 3.0000000000000000, 0.0 },
  { 0.56159390251135533, 3.1000000000000014, 0.0 },
  { 0.46632034695203473, 3.2000000000000028, 0.0 },
  { 0.40569440370625831, 3.3000000000000007, 0.0 },
  { 0.43849170336380444, 3.4000000000000021, 0.0 },
  { 0.53257243502800067, 3.5000000000000000, 0.0 },
  { 0.58795325967341572, 3.6000000000000014, 0.0 },
  { 0.54194566215448514, 3.7000000000000028, 0.0 },
  { 0.44809494701281916, 3.8000000000000007, 0.0 },
  { 0.42233271026093400, 3.9000000000000021, 0.0 },
  { 0.49842603303817756, 4.0000000000000000, 0.0 },
  { 0.57369563145120572, 4.1000000000000014, 0.0 },
  { 0.54171920316341282, 4.2000000000000028, 0.0 },
  { 0.44944117102490871, 4.3000000000000007, 0.0 },
  { 0.43833294083767993, 4.4000000000000021, 0.0 },
  { 0.52602591505353857, 4.5000000000000000, 0.0 },
  { 0.56723668228574731, 4.6000000000000014, 0.0 },
  { 0.49142649060102273, 4.7000000000000028, 0.0 },
  { 0.43379658162299606, 4.8000000000000007, 0.0 },
  { 0.50016096751230488, 4.9000000000000021, 0.0 },
  { 0.56363118870401219, 5.0000000000000000, 0.0 },
  { 0.49978210997689265, 5.1000000000000014, 0.0 },
  { 0.43888747422774249, 5.2000000000000028, 0.0 },
  { 0.50778657415527018, 5.3000000000000007, 0.0 },
  { 0.55723378101789045, 5.4000000000000021, 0.0 },
  { 0.47842141492531443, 5.5000000000000000, 0.0 },
  { 0.45171362460101699, 5.6000000000000014, 0.0 },
  { 0.53845895660669096, 5.7000000000000028, 0.0 },
  { 0.52983671597522830, 5.8000000000000007, 0.0 },
  { 0.44859195316982953, 5.9000000000000021, 0.0 },
  { 0.49953146785550101, 6.0000000000000000, 0.0 },
  { 0.54950220126396487, 6.1000000000000014, 0.0 },
  { 0.46760840976352314, 6.2000000000000028, 0.0 },
  { 0.47600445535306879, 6.3000000000000007, 0.0 },
  { 0.54960455570382438, 6.4000000000000021, 0.0 },
  { 0.48160345989096404, 6.5000000000000000, 0.0 },
  { 0.46899140771179487, 6.6000000000000014, 0.0 },
  { 0.54673657485137017, 6.7000000000000028, 0.0 },
  { 0.48306982803366877, 6.8000000000000007, 0.0 },
  { 0.47322531435151527, 6.9000000000000021, 0.0 },
  { 0.54546709254696979, 7.0000000000000000, 0.0 },
  { 0.47331119669658966, 7.1000000000000014, 0.0 },
  { 0.48874395365162165, 7.2000000000000028, 0.0 },
  { 0.53926801565846216, 7.3000000000000007, 0.0 },
  { 0.46010185207947968, 7.4000000000000021, 0.0 },
  { 0.51601825015233616, 7.5000000000000000, 0.0 },
  { 0.51563121965150827, 7.6000000000000014, 0.0 },
  { 0.46278209682263360, 7.7000000000000028, 0.0 },
  { 0.53947055265520327, 7.8000000000000007, 0.0 },
  { 0.47597379384841054, 7.9000000000000021, 0.0 },
  { 0.49980218037719698, 8.0000000000000000, 0.0 },
  { 0.52275061255785460, 8.1000000000000014, 0.0 },
  { 0.46384247668932821, 8.2000000000000028, 0.0 },
  { 0.53774664841866171, 8.3000000000000007, 0.0 },
  { 0.47091285899291263, 8.4000000000000021, 0.0 },
  { 0.51417759858373324, 8.5000000000000000, 0.0 },
  { 0.50248286002240117, 8.6000000000000014, 0.0 },
  { 0.48274465367209329, 8.7000000000000028, 0.0 },
  { 0.52796401615121191, 8.8000000000000007, 0.0 },
  { 0.46611820459610070, 8.9000000000000021, 0.0 },
  { 0.53536612746811985, 9.0000000000000000, 0.0 },
  { 0.46660822007983410, 9.1000000000000014, 0.0 },
  { 0.52914187331455753, 9.2000000000000028, 0.0 },
  { 0.47627249167238267, 9.3000000000000007, 0.0 },
  { 0.51804088703209816, 9.4000000000000021, 0.0 },
  { 0.48728733102656768, 9.5000000000000000, 0.0 },
  { 0.50813468155278452, 9.6000000000000014, 0.0 },
  { 0.49548631053138775, 9.7000000000000028, 0.0 },
  { 0.50193198474002010, 9.8000000000000007, 0.0 },
  { 0.49959937948871569, 9.9000000000000021, 0.0 },
  { 0.49989869420551575, 10.000000000000000, 0.0 },
  { 0.49960330016607951, 10.100000000000001, 0.0 },
  { 0.50186416397596911, 10.200000000000003, 0.0 },
  { 0.49573750967047570, 10.300000000000001, 0.0 },
  { 0.50752415099885018, 10.400000000000002, 0.0 },
  { 0.48848000730270952, 10.500000000000000, 0.0 },
  { 0.51601826184087196, 10.600000000000001, 0.0 },
  { 0.47935744532441749, 10.700000000000003, 0.0 },
  { 0.52484134447409447, 10.800000000000001, 0.0 },
  { 0.47211182702492382, 10.900000000000002, 0.0 },
  { 0.52893666175579646, 11.000000000000000, 0.0 },
  { 0.47284606849031785, 11.100000000000001, 0.0 },
  { 0.52194393395003602, 11.200000000000003, 0.0 },
  { 0.48675707020411851, 11.300000000000001, 0.0 },
  { 0.50182144813012142, 11.400000000000002, 0.0 },
  { 0.51053061299658087, 11.500000000000000, 0.0 },
  { 0.47889845363079608, 11.600000000000001, 0.0 },
  { 0.52678954755926388, 11.700000000000003, 0.0 },
  { 0.47489658800882628, 11.800000000000001, 0.0 },
  { 0.51542961511130969, 11.900000000000002, 0.0 },
  { 0.49994136935201117, 12.000000000000000, 0.0 },
  { 0.48425094119563328, 12.100000000000001, 0.0 },
  { 0.52525705613894935, 12.200000000000003, 0.0 },
  { 0.47673643299215240, 12.300000000000004, 0.0 },
  { 0.50949909848663488, 12.399999999999999, 0.0 },
  { 0.50969690766970033, 12.500000000000000, 0.0 },
  { 0.47653027345084820, 12.600000000000001, 0.0 },
  { 0.52252945403720485, 12.700000000000003, 0.0 },
  { 0.49376886669640369, 12.800000000000004, 0.0 },
  { 0.48522242457763337, 12.899999999999999, 0.0 },
  { 0.52448511530435837, 13.000000000000000, 0.0 },
  { 0.48599152742744628, 13.100000000000001, 0.0 },
  { 0.49116394923384271, 13.200000000000003, 0.0 },
  { 0.52356906141782944, 13.300000000000004, 0.0 },
  { 0.48482602942492592, 13.399999999999999, 0.0 },
  { 0.49101502211761572, 13.500000000000000, 0.0 },
  { 0.52335621741310323, 13.600000000000001, 0.0 },
  { 0.48909325067276610, 13.700000000000003, 0.0 },
  { 0.48532704835825485, 13.800000000000004, 0.0 },
  { 0.52167739061099583, 13.899999999999999, 0.0 },
  { 0.49996307683096536, 14.000000000000000, 0.0 },
  { 0.47843360440911559, 14.100000000000001, 0.0 },
  { 0.51204098153902899, 14.200000000000003, 0.0 },
  { 0.51546562986270061, 14.300000000000004, 0.0 },
  { 0.48131820590404528, 14.399999999999999, 0.0 },
  { 0.49162993982669234, 14.500000000000000, 0.0 },
  { 0.52112505061981074, 14.600000000000001, 0.0 },
  { 0.50301944026109613, 14.700000000000003, 0.0 },
  { 0.47853318879141177, 14.800000000000004, 0.0 },
  { 0.49969507028487931, 14.899999999999999, 0.0 },
  { 0.52122053167437343, 15.000000000000000, 0.0 },
  { 0.50030168617863646, 15.100000000000001, 0.0 },
  { 0.47909819071930954, 15.200000000000003, 0.0 },
  { 0.49709663357907818, 15.300000000000004, 0.0 },
  { 0.52002689440795713, 15.399999999999999, 0.0 },
  { 0.50783365540525172, 15.500000000000000, 0.0 },
  { 0.48275771612353241, 15.600000000000001, 0.0 },
  { 0.48590957756653136, 15.700000000000003, 0.0 },
  { 0.51081650712718152, 15.800000000000004, 0.0 },
  { 0.51912698592690043, 15.899999999999999, 0.0 },
  { 0.49997526395650010, 16.000000000000000, 0.0 },
  { 0.48128735577455528, 16.100000000000001, 0.0 },
  { 0.48749382753787690, 16.200000000000003, 0.0 },
  { 0.50915847008367898, 16.300000000000004, 0.0 },
  { 0.51936931621446303, 16.399999999999999, 0.0 },
  { 0.50736167237605390, 16.500000000000000, 0.0 },
  { 0.48776018968221224, 16.600000000000001, 0.0 },
  { 0.48122716459814369, 16.700000000000003, 0.0 },
  { 0.49304503191813792, 16.800000000000004, 0.0 },
  { 0.51084730239743092, 16.899999999999999, 0.0 },
  { 0.51872404281097373, 17.000000000000000, 0.0 },
  { 0.51116034650988751, 17.100000000000001, 0.0 },
  { 0.49537837816357261, 17.200000000000003, 0.0 },
  { 0.48346826478202209, 17.300000000000004, 0.0 },
  { 0.48299811079987987, 17.399999999999999, 0.0 },
  { 0.49305680746541819, 17.500000000000000, 0.0 },
  { 0.50667508150034346, 17.600000000000001, 0.0 },
  { 0.51615776547018966, 17.700000000000003, 0.0 },
  { 0.51731624358389883, 17.800000000000004, 0.0 },
  { 0.51066291912679762, 17.899999999999999, 0.0 },
  { 0.49998262693469964, 18.000000000000000, 0.0 },
  { 0.48987390239407780, 18.100000000000001, 0.0 },
  { 0.48373248189252888, 18.200000000000003, 0.0 },
  { 0.48286791414803332, 18.300000000000004, 0.0 },
  { 0.48668094715992999, 18.400000000000006, 0.0 },
  { 0.49343037308486531, 18.500000000000000, 0.0 },
  { 0.50109027313941557, 18.600000000000001, 0.0 },
  { 0.50797873688883899, 18.700000000000003, 0.0 },
  { 0.51305553802784387, 18.800000000000004, 0.0 },
  { 0.51593859694716748, 18.900000000000006, 0.0 },
  { 0.51675311283005532, 19.000000000000000, 0.0 },
  { 0.51592439822004366, 19.100000000000001, 0.0 },
  { 0.51399010696334091, 19.200000000000003, 0.0 },
  { 0.51146736280129212, 19.300000000000004, 0.0 },
  { 0.50877996382010038, 19.400000000000006, 0.0 },
  { 0.50623412768912091, 19.500000000000000, 0.0 },
  { 0.50402575653177129, 19.600000000000001, 0.0 },
  { 0.50226353783109856, 19.700000000000003, 0.0 },
  { 0.50099640758067077, 19.800000000000004, 0.0 },
  { 0.50023839013189719, 19.900000000000006, 0.0 },
  { 0.49998733497234443, 20.000000000000000, 0.0 },
};
const double toler001 = 2.5000000000000020e-13;

template<typename Ret, unsigned int Num>
  void
  test(const testcase_fresnel_c<Ret> (&data)[Num], Ret toler)
  {
    bool test __attribute__((unused)) = true;
    const Ret eps = std::numeric_limits<Ret>::epsilon();
    Ret max_abs_diff = -Ret(1);
    Ret max_abs_frac = -Ret(1);
    unsigned int num_datum = Num;
    for (unsigned int i = 0; i < num_datum; ++i)
      {
	const Ret f = __gnu_cxx::fresnel_c(data[i].x);
	const Ret f0 = data[i].f0;
	const Ret diff = f - f0;
	if (std::abs(diff) > max_abs_diff)
	  max_abs_diff = std::abs(diff);
	if (std::abs(f0) > Ret(10) * eps
	 && std::abs(f) > Ret(10) * eps)
	  {
	    const Ret frac = diff / f0;
	    if (std::abs(frac) > max_abs_frac)
	      max_abs_frac = std::abs(frac);
	  }
      }
    VERIFY(max_abs_frac < toler);
  }

int
main()
{
  test(data001, toler001);
  return 0;
}
