// { dg-options "-D__STDCPP_WANT_MATH_SPEC_FUNCS__" }
//
// Copyright (C) 2016 Free Software Foundation, Inc.
//
// This file is part of the GNU ISO C++ Library.  This library is free
// software; you can redistribute it and/or modify it under the
// terms of the GNU General Public License as published by the
// Free Software Foundation; either version 3, or (at your option)
// any later version.
//
// This library is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License along
// with this library; see the file COPYING3.  If not see
// <http://www.gnu.org/licenses/>.

//  jacobi_sn
//  Compare against values generated by the GNU Scientific Library.
//  The GSL can be found on the web: http://www.gnu.org/software/gsl/
#include <limits>
#include <cmath>
#if defined(__TEST_DEBUG)
#  include <iostream>
#  define VERIFY(A) \
  if (!(A)) \
    { \
      std::cout << "line " << __LINE__ \
	<< "  max_abs_frac = " << max_abs_frac \
	<< std::endl; \
    }
#else
#  include <testsuite_hooks.h>
#endif
#include <specfun_testcase.h>


// Test data for u=-1.0000000000000000.
// max(|f - f_GSL|): 1.5231883119115297
// max(|f - f_GSL| / |f_GSL|): 2.0000000000000000
const testcase_jacobi_sn<double>
data001[21] =
{
  { -0.76159415595576485, -1.0000000000000000, -1.0000000000000000 },
  { -0.77764212831634771, -1.0000000000000000, -0.90000000000000002 },
  { -0.79168162839625034, -1.0000000000000000, -0.80000000000000004 },
  { -0.80380172005899353, -1.0000000000000000, -0.69999999999999996 },
  { -0.81409141238011851, -1.0000000000000000, -0.59999999999999998 },
  { -0.82263557812986232, -1.0000000000000000, -0.50000000000000000 },
  { -0.82951150451514089, -1.0000000000000000, -0.40000000000000002 },
  { -0.83478606565842461, -1.0000000000000000, -0.30000000000000004 },
  { -0.83851348688113936, -1.0000000000000000, -0.19999999999999996 },
  { -0.84073366201441269, -1.0000000000000000, -0.099999999999999978 },
  { -0.84147098480789650, -1.0000000000000000, 0.0000000000000000 },
  { -0.84073366201441269, -1.0000000000000000, 0.10000000000000009 },
  { -0.83851348688113936, -1.0000000000000000, 0.19999999999999996 },
  { -0.83478606565842461, -1.0000000000000000, 0.30000000000000004 },
  { -0.82951150451514100, -1.0000000000000000, 0.39999999999999991 },
  { -0.82263557812986232, -1.0000000000000000, 0.50000000000000000 },
  { -0.81409141238011828, -1.0000000000000000, 0.60000000000000009 },
  { -0.80380172005899353, -1.0000000000000000, 0.69999999999999996 },
  { -0.79168162839625034, -1.0000000000000000, 0.80000000000000004 },
  { -0.77764212831634771, -1.0000000000000000, 0.89999999999999991 },
  { -0.76159415595576485, -1.0000000000000000, 1.0000000000000000 },
};
const double toler001 = 0.050000000000000003;

// Test data for u=-0.90000000000000036.
// max(|f - f_GSL|): 1.4939399985153716
// max(|f - f_GSL| / |f_GSL|): 2.0856407099190144
const testcase_jacobi_sn<double>
data002[21] =
{
  { -0.71629787019902458, -0.90000000000000036, -1.0000000000000000 },
  { -0.72942664566651516, -0.90000000000000036, -0.90000000000000002 },
  { -0.74103070284234995, -0.90000000000000036, -0.80000000000000004 },
  { -0.75114907234088191, -0.90000000000000036, -0.69999999999999996 },
  { -0.75982123800317514, -0.90000000000000036, -0.59999999999999998 },
  { -0.76708523758272773, -0.90000000000000036, -0.50000000000000000 },
  { -0.77297601414094097, -0.90000000000000036, -0.40000000000000002 },
  { -0.77752402664327158, -0.90000000000000036, -0.30000000000000004 },
  { -0.78075412134555011, -0.90000000000000036, -0.19999999999999996 },
  { -0.78268466132921033, -0.90000000000000036, -0.099999999999999978 },
  { -0.78332690962748364, -0.90000000000000036, 0.0000000000000000 },
  { -0.78268466132921033, -0.90000000000000036, 0.10000000000000009 },
  { -0.78075412134555011, -0.90000000000000036, 0.19999999999999996 },
  { -0.77752402664327158, -0.90000000000000036, 0.30000000000000004 },
  { -0.77297601414094119, -0.90000000000000036, 0.39999999999999991 },
  { -0.76708523758272773, -0.90000000000000036, 0.50000000000000000 },
  { -0.75982123800317514, -0.90000000000000036, 0.60000000000000009 },
  { -0.75114907234088191, -0.90000000000000036, 0.69999999999999996 },
  { -0.74103070284234995, -0.90000000000000036, 0.80000000000000004 },
  { -0.72942664566651527, -0.90000000000000036, 0.89999999999999991 },
  { -0.71629787019902458, -0.90000000000000036, 1.0000000000000000 },
};
const double toler002 = 0.050000000000000003;

// Test data for u=-0.79999999999999982.
// max(|f - f_GSL|): 1.4557183986640991
// max(|f - f_GSL| / |f_GSL|): 2.1922255872621541
const testcase_jacobi_sn<double>
data003[21] =
{
  { -0.66403677026784891, -0.79999999999999982, -1.0000000000000000 },
  { -0.67430705718253059, -0.79999999999999982, -0.90000000000000002 },
  { -0.68344660798596601, -0.79999999999999982, -0.80000000000000004 },
  { -0.69146832464142693, -0.79999999999999982, -0.69999999999999996 },
  { -0.69838572137896415, -0.79999999999999982, -0.59999999999999998 },
  { -0.70421214154716705, -0.79999999999999982, -0.50000000000000000 },
  { -0.70896006689883062, -0.79999999999999982, -0.40000000000000002 },
  { -0.71264052596923799, -0.79999999999999982, -0.30000000000000004 },
  { -0.71526260604783820, -0.79999999999999982, -0.19999999999999996 },
  { -0.71683307160878840, -0.79999999999999982, -0.099999999999999978 },
  { -0.71735609089952268, -0.79999999999999982, 0.0000000000000000 },
  { -0.71683307160878840, -0.79999999999999982, 0.10000000000000009 },
  { -0.71526260604783820, -0.79999999999999982, 0.19999999999999996 },
  { -0.71264052596923799, -0.79999999999999982, 0.30000000000000004 },
  { -0.70896006689883073, -0.79999999999999982, 0.39999999999999991 },
  { -0.70421214154716705, -0.79999999999999982, 0.50000000000000000 },
  { -0.69838572137896415, -0.79999999999999982, 0.60000000000000009 },
  { -0.69146832464142693, -0.79999999999999982, 0.69999999999999996 },
  { -0.68344660798596601, -0.79999999999999982, 0.80000000000000004 },
  { -0.67430705718253059, -0.79999999999999982, 0.89999999999999991 },
  { -0.66403677026784891, -0.79999999999999982, 1.0000000000000000 },
};
const double toler003 = 0.050000000000000003;

// Test data for u=-0.70000000000000018.
// max(|f - f_GSL|): 1.4081694971761571
// max(|f - f_GSL| / |f_GSL|): 2.3299877169049790
const testcase_jacobi_sn<double>
data004[21] =
{
  { -0.60436777711716361, -0.70000000000000018, -1.0000000000000000 },
  { -0.61196584557663802, -0.70000000000000018, -0.90000000000000002 },
  { -0.61875564895254531, -0.70000000000000018, -0.80000000000000004 },
  { -0.62473870640031781, -0.70000000000000018, -0.69999999999999996 },
  { -0.62991711532348693, -0.70000000000000018, -0.59999999999999998 },
  { -0.63429327633511257, -0.70000000000000018, -0.50000000000000000 },
  { -0.63786964879104879, -0.70000000000000018, -0.40000000000000002 },
  { -0.64064853972026237, -0.70000000000000018, -0.30000000000000004 },
  { -0.64263192838746641, -0.70000000000000018, -0.19999999999999996 },
  { -0.64382132820285631, -0.70000000000000018, -0.099999999999999978 },
  { -0.64421768723769124, -0.70000000000000018, 0.0000000000000000 },
  { -0.64382132820285631, -0.70000000000000018, 0.10000000000000009 },
  { -0.64263192838746641, -0.70000000000000018, 0.19999999999999996 },
  { -0.64064853972026237, -0.70000000000000018, 0.30000000000000004 },
  { -0.63786964879104902, -0.70000000000000018, 0.39999999999999991 },
  { -0.63429327633511257, -0.70000000000000018, 0.50000000000000000 },
  { -0.62991711532348671, -0.70000000000000018, 0.60000000000000009 },
  { -0.62473870640031781, -0.70000000000000018, 0.69999999999999996 },
  { -0.61875564895254531, -0.70000000000000018, 0.80000000000000004 },
  { -0.61196584557663802, -0.70000000000000018, 0.89999999999999991 },
  { -0.60436777711716361, -0.70000000000000018, 1.0000000000000000 },
};
const double toler004 = 0.050000000000000003;

// Test data for u=-0.59999999999999964.
// max(|f - f_GSL|): 1.3511409793781537
// max(|f - f_GSL| / |f_GSL|): 2.5158589865934986
const testcase_jacobi_sn<double>
data005[21] =
{
  { -0.53704956699803508, -0.59999999999999964, -1.0000000000000000 },
  { -0.54228232286915878, -0.59999999999999964, -0.90000000000000002 },
  { -0.54696879468827075, -0.59999999999999964, -0.80000000000000004 },
  { -0.55110710214781278, -0.59999999999999964, -0.69999999999999996 },
  { -0.55469580037742949, -0.59999999999999964, -0.59999999999999998 },
  { -0.55773380237106107, -0.59999999999999964, -0.50000000000000000 },
  { -0.56022030990165361, -0.59999999999999964, -0.40000000000000002 },
  { -0.56215475373270829, -0.59999999999999964, -0.30000000000000004 },
  { -0.56353674380135255, -0.59999999999999964, -0.19999999999999996 },
  { -0.56436602991718932, -0.59999999999999964, -0.099999999999999978 },
  { -0.56464247339503504, -0.59999999999999964, 0.0000000000000000 },
  { -0.56436602991718932, -0.59999999999999964, 0.10000000000000009 },
  { -0.56353674380135255, -0.59999999999999964, 0.19999999999999996 },
  { -0.56215475373270829, -0.59999999999999964, 0.30000000000000004 },
  { -0.56022030990165383, -0.59999999999999964, 0.39999999999999991 },
  { -0.55773380237106107, -0.59999999999999964, 0.50000000000000000 },
  { -0.55469580037742938, -0.59999999999999964, 0.60000000000000009 },
  { -0.55110710214781278, -0.59999999999999964, 0.69999999999999996 },
  { -0.54696879468827075, -0.59999999999999964, 0.80000000000000004 },
  { -0.54228232286915878, -0.59999999999999964, 0.89999999999999991 },
  { -0.53704956699803508, -0.59999999999999964, 1.0000000000000000 },
};
const double toler005 = 0.050000000000000003;

// Test data for u=-0.50000000000000000.
// max(|f - f_GSL|): 1.2847527353898720
// max(|f - f_GSL| / |f_GSL|): 2.7801450675569859
const testcase_jacobi_sn<double>
data006[21] =
{
  { -0.46211715726000974, -0.50000000000000000, -1.0000000000000000 },
  { -0.46539274997749236, -0.50000000000000000, -0.90000000000000002 },
  { -0.46832883538821451, -0.50000000000000000, -0.80000000000000004 },
  { -0.47092357369852278, -0.50000000000000000, -0.69999999999999996 },
  { -0.47317538554245181, -0.50000000000000000, -0.59999999999999998 },
  { -0.47508293602853652, -0.50000000000000000, -0.50000000000000000 },
  { -0.47664512055443758, -0.50000000000000000, -0.40000000000000002 },
  { -0.47786105254271594, -0.50000000000000000, -0.30000000000000004 },
  { -0.47873005322805673, -0.50000000000000000, -0.19999999999999996 },
  { -0.47925164360280970, -0.50000000000000000, -0.099999999999999978 },
  { -0.47942553860420301, -0.50000000000000000, 0.0000000000000000 },
  { -0.47925164360280970, -0.50000000000000000, 0.10000000000000009 },
  { -0.47873005322805673, -0.50000000000000000, 0.19999999999999996 },
  { -0.47786105254271594, -0.50000000000000000, 0.30000000000000004 },
  { -0.47664512055443753, -0.50000000000000000, 0.39999999999999991 },
  { -0.47508293602853652, -0.50000000000000000, 0.50000000000000000 },
  { -0.47317538554245175, -0.50000000000000000, 0.60000000000000009 },
  { -0.47092357369852278, -0.50000000000000000, 0.69999999999999996 },
  { -0.46832883538821451, -0.50000000000000000, 0.80000000000000004 },
  { -0.46539274997749236, -0.50000000000000000, 0.89999999999999991 },
  { -0.46211715726000974, -0.50000000000000000, 1.0000000000000000 },
};
const double toler006 = 0.050000000000000003;

// Test data for u=-0.40000000000000036.
// max(|f - f_GSL|): 1.2094604667703663
// max(|f - f_GSL| / |f_GSL|): 3.1832182396064255
const testcase_jacobi_sn<double>
data007[21] =
{
  { -0.37994896225522523, -0.40000000000000036, -1.0000000000000000 },
  { -0.38174107346958025, -0.40000000000000036, -0.90000000000000002 },
  { -0.38334736833726596, -0.40000000000000036, -0.80000000000000004 },
  { -0.38476689519885077, -0.40000000000000036, -0.69999999999999996 },
  { -0.38599881978357847, -0.40000000000000036, -0.59999999999999998 },
  { -0.38704242323395915, -0.40000000000000036, -0.50000000000000000 },
  { -0.38789710035366443, -0.40000000000000036, -0.40000000000000002 },
  { -0.38856235809574036, -0.40000000000000036, -0.30000000000000004 },
  { -0.38903781430567547, -0.40000000000000036, -0.19999999999999996 },
  { -0.38932319673126409, -0.40000000000000036, -0.099999999999999978 },
  { -0.38941834230865080, -0.40000000000000036, 0.0000000000000000 },
  { -0.38932319673126409, -0.40000000000000036, 0.10000000000000009 },
  { -0.38903781430567547, -0.40000000000000036, 0.19999999999999996 },
  { -0.38856235809574036, -0.40000000000000036, 0.30000000000000004 },
  { -0.38789710035366454, -0.40000000000000036, 0.39999999999999991 },
  { -0.38704242323395915, -0.40000000000000036, 0.50000000000000000 },
  { -0.38599881978357825, -0.40000000000000036, 0.60000000000000009 },
  { -0.38476689519885077, -0.40000000000000036, 0.69999999999999996 },
  { -0.38334736833726596, -0.40000000000000036, 0.80000000000000004 },
  { -0.38174107346958003, -0.40000000000000036, 0.89999999999999991 },
  { -0.37994896225522523, -0.40000000000000036, 1.0000000000000000 },
};
const double toler007 = 0.050000000000000003;

// Test data for u=-0.29999999999999982.
// max(|f - f_GSL|): 1.1260986781100155
// max(|f - f_GSL| / |f_GSL|): 3.8656022086827644
const testcase_jacobi_sn<double>
data008[21] =
{
  { -0.29131261245159079, -0.29999999999999982, -1.0000000000000000 },
  { -0.29210979143104610, -0.29999999999999982, -0.90000000000000002 },
  { -0.29282395770855202, -0.29999999999999982, -0.80000000000000004 },
  { -0.29345481061991779, -0.29999999999999982, -0.69999999999999996 },
  { -0.29400208508895365, -0.29999999999999982, -0.59999999999999998 },
  { -0.29446555154955600, -0.29999999999999982, -0.50000000000000000 },
  { -0.29484501587619383, -0.29999999999999982, -0.40000000000000002 },
  { -0.29514031932364004, -0.29999999999999982, -0.30000000000000004 },
  { -0.29535133847668182, -0.29999999999999982, -0.19999999999999996 },
  { -0.29547798521037710, -0.29999999999999982, -0.099999999999999978 },
  { -0.29552020666133938, -0.29999999999999982, 0.0000000000000000 },
  { -0.29547798521037710, -0.29999999999999982, 0.10000000000000009 },
  { -0.29535133847668182, -0.29999999999999982, 0.19999999999999996 },
  { -0.29514031932364004, -0.29999999999999982, 0.30000000000000004 },
  { -0.29484501587619399, -0.29999999999999982, 0.39999999999999991 },
  { -0.29446555154955600, -0.29999999999999982, 0.50000000000000000 },
  { -0.29400208508895354, -0.29999999999999982, 0.60000000000000009 },
  { -0.29345481061991779, -0.29999999999999982, 0.69999999999999996 },
  { -0.29282395770855202, -0.29999999999999982, 0.80000000000000004 },
  { -0.29210979143104604, -0.29999999999999982, 0.89999999999999991 },
  { -0.29131261245159079, -0.29999999999999982, 1.0000000000000000 },
};
const double toler008 = 0.050000000000000003;

// Test data for u=-0.20000000000000018.
// max(|f - f_GSL|): 1.0358888071060435
// max(|f - f_GSL| / |f_GSL|): 5.2483198300865297
const testcase_jacobi_sn<double>
data009[21] =
{
  { -0.19737532022490417, -0.20000000000000018, -1.0000000000000000 },
  { -0.19762082367187717, -0.20000000000000018, -0.90000000000000002 },
  { -0.19784062720132034, -0.20000000000000018, -0.80000000000000004 },
  { -0.19803468331843993, -0.20000000000000018, -0.69999999999999996 },
  { -0.19820295010304625, -0.20000000000000018, -0.59999999999999998 },
  { -0.19834539121447212, -0.20000000000000018, -0.50000000000000000 },
  { -0.19846197589580930, -0.20000000000000018, -0.40000000000000002 },
  { -0.19855267897747422, -0.20000000000000018, -0.30000000000000004 },
  { -0.19861748088012368, -0.20000000000000018, -0.19999999999999996 },
  { -0.19865636761690406, -0.20000000000000018, -0.099999999999999978 },
  { -0.19866933079506138, -0.20000000000000018, 0.0000000000000000 },
  { -0.19865636761690406, -0.20000000000000018, 0.10000000000000009 },
  { -0.19861748088012368, -0.20000000000000018, 0.19999999999999996 },
  { -0.19855267897747422, -0.20000000000000018, 0.30000000000000004 },
  { -0.19846197589580930, -0.20000000000000018, 0.39999999999999991 },
  { -0.19834539121447212, -0.20000000000000018, 0.50000000000000000 },
  { -0.19820295010304623, -0.20000000000000018, 0.60000000000000009 },
  { -0.19803468331843993, -0.20000000000000018, 0.69999999999999996 },
  { -0.19784062720132034, -0.20000000000000018, 0.80000000000000004 },
  { -0.19762082367187711, -0.20000000000000018, 0.89999999999999991 },
  { -0.19737532022490417, -0.20000000000000018, 1.0000000000000000 },
};
const double toler009 = 0.050000000000000003;

// Test data for u=-0.099999999999999645.
// max(|f - f_GSL|): 0.94040165663936814
// max(|f - f_GSL| / |f_GSL|): 9.4353424103498984
const testcase_jacobi_sn<double>
data010[21] =
{
  { -0.099667994624955472, -0.099999999999999645, -1.0000000000000000 },
  { -0.099699412398622525, -0.099999999999999645, -0.90000000000000002 },
  { -0.099727527972737845, -0.099999999999999645, -0.80000000000000004 },
  { -0.099752339702866469, -0.099999999999999645, -0.69999999999999996 },
  { -0.099773846137797759, -0.099999999999999645, -0.59999999999999998 },
  { -0.099792046019636010, -0.099999999999999645, -0.50000000000000000 },
  { -0.099806938283877406, -0.099999999999999645, -0.40000000000000002 },
  { -0.099818522059474168, -0.099999999999999645, -0.30000000000000004 },
  { -0.099826796668890799, -0.099999999999999645, -0.19999999999999996 },
  { -0.099831761628142890, -0.099999999999999645, -0.099999999999999978 },
  { -0.099833416646827794, -0.099999999999999645, 0.0000000000000000 },
  { -0.099831761628142890, -0.099999999999999645, 0.10000000000000009 },
  { -0.099826796668890799, -0.099999999999999645, 0.19999999999999996 },
  { -0.099818522059474168, -0.099999999999999645, 0.30000000000000004 },
  { -0.099806938283877419, -0.099999999999999645, 0.39999999999999991 },
  { -0.099792046019636010, -0.099999999999999645, 0.50000000000000000 },
  { -0.099773846137797731, -0.099999999999999645, 0.60000000000000009 },
  { -0.099752339702866469, -0.099999999999999645, 0.69999999999999996 },
  { -0.099727527972737845, -0.099999999999999645, 0.80000000000000004 },
  { -0.099699412398622511, -0.099999999999999645, 0.89999999999999991 },
  { -0.099667994624955472, -0.099999999999999645, 1.0000000000000000 },
};
const double toler010 = 0.050000000000000003;

// Test data for u=0.099999999999999645.
// max(|f - f_GSL|): 0.94040165663936814
// max(|f - f_GSL| / |f_GSL|): 9.4353424103498984
const testcase_jacobi_sn<double>
data011[21] =
{
  { 0.099667994624955472, 0.099999999999999645, -1.0000000000000000 },
  { 0.099699412398622525, 0.099999999999999645, -0.90000000000000002 },
  { 0.099727527972737845, 0.099999999999999645, -0.80000000000000004 },
  { 0.099752339702866469, 0.099999999999999645, -0.69999999999999996 },
  { 0.099773846137797759, 0.099999999999999645, -0.59999999999999998 },
  { 0.099792046019636010, 0.099999999999999645, -0.50000000000000000 },
  { 0.099806938283877406, 0.099999999999999645, -0.40000000000000002 },
  { 0.099818522059474168, 0.099999999999999645, -0.30000000000000004 },
  { 0.099826796668890799, 0.099999999999999645, -0.19999999999999996 },
  { 0.099831761628142890, 0.099999999999999645, -0.099999999999999978 },
  { 0.099833416646827794, 0.099999999999999645, 0.0000000000000000 },
  { 0.099831761628142890, 0.099999999999999645, 0.10000000000000009 },
  { 0.099826796668890799, 0.099999999999999645, 0.19999999999999996 },
  { 0.099818522059474168, 0.099999999999999645, 0.30000000000000004 },
  { 0.099806938283877419, 0.099999999999999645, 0.39999999999999991 },
  { 0.099792046019636010, 0.099999999999999645, 0.50000000000000000 },
  { 0.099773846137797731, 0.099999999999999645, 0.60000000000000009 },
  { 0.099752339702866469, 0.099999999999999645, 0.69999999999999996 },
  { 0.099727527972737845, 0.099999999999999645, 0.80000000000000004 },
  { 0.099699412398622511, 0.099999999999999645, 0.89999999999999991 },
  { 0.099667994624955472, 0.099999999999999645, 1.0000000000000000 },
};
const double toler011 = 0.050000000000000003;

// Test data for u=0.20000000000000018.
// max(|f - f_GSL|): 1.0358888071060435
// max(|f - f_GSL| / |f_GSL|): 5.2483198300865297
const testcase_jacobi_sn<double>
data012[21] =
{
  { 0.19737532022490417, 0.20000000000000018, -1.0000000000000000 },
  { 0.19762082367187717, 0.20000000000000018, -0.90000000000000002 },
  { 0.19784062720132034, 0.20000000000000018, -0.80000000000000004 },
  { 0.19803468331843993, 0.20000000000000018, -0.69999999999999996 },
  { 0.19820295010304625, 0.20000000000000018, -0.59999999999999998 },
  { 0.19834539121447212, 0.20000000000000018, -0.50000000000000000 },
  { 0.19846197589580930, 0.20000000000000018, -0.40000000000000002 },
  { 0.19855267897747422, 0.20000000000000018, -0.30000000000000004 },
  { 0.19861748088012368, 0.20000000000000018, -0.19999999999999996 },
  { 0.19865636761690406, 0.20000000000000018, -0.099999999999999978 },
  { 0.19866933079506138, 0.20000000000000018, 0.0000000000000000 },
  { 0.19865636761690406, 0.20000000000000018, 0.10000000000000009 },
  { 0.19861748088012368, 0.20000000000000018, 0.19999999999999996 },
  { 0.19855267897747422, 0.20000000000000018, 0.30000000000000004 },
  { 0.19846197589580930, 0.20000000000000018, 0.39999999999999991 },
  { 0.19834539121447212, 0.20000000000000018, 0.50000000000000000 },
  { 0.19820295010304623, 0.20000000000000018, 0.60000000000000009 },
  { 0.19803468331843993, 0.20000000000000018, 0.69999999999999996 },
  { 0.19784062720132034, 0.20000000000000018, 0.80000000000000004 },
  { 0.19762082367187711, 0.20000000000000018, 0.89999999999999991 },
  { 0.19737532022490417, 0.20000000000000018, 1.0000000000000000 },
};
const double toler012 = 0.050000000000000003;

// Test data for u=0.29999999999999982.
// max(|f - f_GSL|): 1.1260986781100155
// max(|f - f_GSL| / |f_GSL|): 3.8656022086827644
const testcase_jacobi_sn<double>
data013[21] =
{
  { 0.29131261245159079, 0.29999999999999982, -1.0000000000000000 },
  { 0.29210979143104610, 0.29999999999999982, -0.90000000000000002 },
  { 0.29282395770855202, 0.29999999999999982, -0.80000000000000004 },
  { 0.29345481061991779, 0.29999999999999982, -0.69999999999999996 },
  { 0.29400208508895365, 0.29999999999999982, -0.59999999999999998 },
  { 0.29446555154955600, 0.29999999999999982, -0.50000000000000000 },
  { 0.29484501587619383, 0.29999999999999982, -0.40000000000000002 },
  { 0.29514031932364004, 0.29999999999999982, -0.30000000000000004 },
  { 0.29535133847668182, 0.29999999999999982, -0.19999999999999996 },
  { 0.29547798521037710, 0.29999999999999982, -0.099999999999999978 },
  { 0.29552020666133938, 0.29999999999999982, 0.0000000000000000 },
  { 0.29547798521037710, 0.29999999999999982, 0.10000000000000009 },
  { 0.29535133847668182, 0.29999999999999982, 0.19999999999999996 },
  { 0.29514031932364004, 0.29999999999999982, 0.30000000000000004 },
  { 0.29484501587619399, 0.29999999999999982, 0.39999999999999991 },
  { 0.29446555154955600, 0.29999999999999982, 0.50000000000000000 },
  { 0.29400208508895354, 0.29999999999999982, 0.60000000000000009 },
  { 0.29345481061991779, 0.29999999999999982, 0.69999999999999996 },
  { 0.29282395770855202, 0.29999999999999982, 0.80000000000000004 },
  { 0.29210979143104604, 0.29999999999999982, 0.89999999999999991 },
  { 0.29131261245159079, 0.29999999999999982, 1.0000000000000000 },
};
const double toler013 = 0.050000000000000003;

// Test data for u=0.40000000000000036.
// max(|f - f_GSL|): 1.2094604667703663
// max(|f - f_GSL| / |f_GSL|): 3.1832182396064255
const testcase_jacobi_sn<double>
data014[21] =
{
  { 0.37994896225522523, 0.40000000000000036, -1.0000000000000000 },
  { 0.38174107346958025, 0.40000000000000036, -0.90000000000000002 },
  { 0.38334736833726596, 0.40000000000000036, -0.80000000000000004 },
  { 0.38476689519885077, 0.40000000000000036, -0.69999999999999996 },
  { 0.38599881978357847, 0.40000000000000036, -0.59999999999999998 },
  { 0.38704242323395915, 0.40000000000000036, -0.50000000000000000 },
  { 0.38789710035366443, 0.40000000000000036, -0.40000000000000002 },
  { 0.38856235809574036, 0.40000000000000036, -0.30000000000000004 },
  { 0.38903781430567547, 0.40000000000000036, -0.19999999999999996 },
  { 0.38932319673126409, 0.40000000000000036, -0.099999999999999978 },
  { 0.38941834230865080, 0.40000000000000036, 0.0000000000000000 },
  { 0.38932319673126409, 0.40000000000000036, 0.10000000000000009 },
  { 0.38903781430567547, 0.40000000000000036, 0.19999999999999996 },
  { 0.38856235809574036, 0.40000000000000036, 0.30000000000000004 },
  { 0.38789710035366454, 0.40000000000000036, 0.39999999999999991 },
  { 0.38704242323395915, 0.40000000000000036, 0.50000000000000000 },
  { 0.38599881978357825, 0.40000000000000036, 0.60000000000000009 },
  { 0.38476689519885077, 0.40000000000000036, 0.69999999999999996 },
  { 0.38334736833726596, 0.40000000000000036, 0.80000000000000004 },
  { 0.38174107346958003, 0.40000000000000036, 0.89999999999999991 },
  { 0.37994896225522523, 0.40000000000000036, 1.0000000000000000 },
};
const double toler014 = 0.050000000000000003;

// Test data for u=0.50000000000000000.
// max(|f - f_GSL|): 1.2847527353898720
// max(|f - f_GSL| / |f_GSL|): 2.7801450675569859
const testcase_jacobi_sn<double>
data015[21] =
{
  { 0.46211715726000974, 0.50000000000000000, -1.0000000000000000 },
  { 0.46539274997749236, 0.50000000000000000, -0.90000000000000002 },
  { 0.46832883538821451, 0.50000000000000000, -0.80000000000000004 },
  { 0.47092357369852278, 0.50000000000000000, -0.69999999999999996 },
  { 0.47317538554245181, 0.50000000000000000, -0.59999999999999998 },
  { 0.47508293602853652, 0.50000000000000000, -0.50000000000000000 },
  { 0.47664512055443758, 0.50000000000000000, -0.40000000000000002 },
  { 0.47786105254271594, 0.50000000000000000, -0.30000000000000004 },
  { 0.47873005322805673, 0.50000000000000000, -0.19999999999999996 },
  { 0.47925164360280970, 0.50000000000000000, -0.099999999999999978 },
  { 0.47942553860420301, 0.50000000000000000, 0.0000000000000000 },
  { 0.47925164360280970, 0.50000000000000000, 0.10000000000000009 },
  { 0.47873005322805673, 0.50000000000000000, 0.19999999999999996 },
  { 0.47786105254271594, 0.50000000000000000, 0.30000000000000004 },
  { 0.47664512055443753, 0.50000000000000000, 0.39999999999999991 },
  { 0.47508293602853652, 0.50000000000000000, 0.50000000000000000 },
  { 0.47317538554245175, 0.50000000000000000, 0.60000000000000009 },
  { 0.47092357369852278, 0.50000000000000000, 0.69999999999999996 },
  { 0.46832883538821451, 0.50000000000000000, 0.80000000000000004 },
  { 0.46539274997749236, 0.50000000000000000, 0.89999999999999991 },
  { 0.46211715726000974, 0.50000000000000000, 1.0000000000000000 },
};
const double toler015 = 0.050000000000000003;

// Test data for u=0.59999999999999964.
// max(|f - f_GSL|): 1.3511409793781537
// max(|f - f_GSL| / |f_GSL|): 2.5158589865934986
const testcase_jacobi_sn<double>
data016[21] =
{
  { 0.53704956699803508, 0.59999999999999964, -1.0000000000000000 },
  { 0.54228232286915878, 0.59999999999999964, -0.90000000000000002 },
  { 0.54696879468827075, 0.59999999999999964, -0.80000000000000004 },
  { 0.55110710214781278, 0.59999999999999964, -0.69999999999999996 },
  { 0.55469580037742949, 0.59999999999999964, -0.59999999999999998 },
  { 0.55773380237106107, 0.59999999999999964, -0.50000000000000000 },
  { 0.56022030990165361, 0.59999999999999964, -0.40000000000000002 },
  { 0.56215475373270829, 0.59999999999999964, -0.30000000000000004 },
  { 0.56353674380135255, 0.59999999999999964, -0.19999999999999996 },
  { 0.56436602991718932, 0.59999999999999964, -0.099999999999999978 },
  { 0.56464247339503504, 0.59999999999999964, 0.0000000000000000 },
  { 0.56436602991718932, 0.59999999999999964, 0.10000000000000009 },
  { 0.56353674380135255, 0.59999999999999964, 0.19999999999999996 },
  { 0.56215475373270829, 0.59999999999999964, 0.30000000000000004 },
  { 0.56022030990165383, 0.59999999999999964, 0.39999999999999991 },
  { 0.55773380237106107, 0.59999999999999964, 0.50000000000000000 },
  { 0.55469580037742938, 0.59999999999999964, 0.60000000000000009 },
  { 0.55110710214781278, 0.59999999999999964, 0.69999999999999996 },
  { 0.54696879468827075, 0.59999999999999964, 0.80000000000000004 },
  { 0.54228232286915878, 0.59999999999999964, 0.89999999999999991 },
  { 0.53704956699803508, 0.59999999999999964, 1.0000000000000000 },
};
const double toler016 = 0.050000000000000003;

// Test data for u=0.70000000000000018.
// max(|f - f_GSL|): 1.4081694971761571
// max(|f - f_GSL| / |f_GSL|): 2.3299877169049790
const testcase_jacobi_sn<double>
data017[21] =
{
  { 0.60436777711716361, 0.70000000000000018, -1.0000000000000000 },
  { 0.61196584557663802, 0.70000000000000018, -0.90000000000000002 },
  { 0.61875564895254531, 0.70000000000000018, -0.80000000000000004 },
  { 0.62473870640031781, 0.70000000000000018, -0.69999999999999996 },
  { 0.62991711532348693, 0.70000000000000018, -0.59999999999999998 },
  { 0.63429327633511257, 0.70000000000000018, -0.50000000000000000 },
  { 0.63786964879104879, 0.70000000000000018, -0.40000000000000002 },
  { 0.64064853972026237, 0.70000000000000018, -0.30000000000000004 },
  { 0.64263192838746641, 0.70000000000000018, -0.19999999999999996 },
  { 0.64382132820285631, 0.70000000000000018, -0.099999999999999978 },
  { 0.64421768723769124, 0.70000000000000018, 0.0000000000000000 },
  { 0.64382132820285631, 0.70000000000000018, 0.10000000000000009 },
  { 0.64263192838746641, 0.70000000000000018, 0.19999999999999996 },
  { 0.64064853972026237, 0.70000000000000018, 0.30000000000000004 },
  { 0.63786964879104902, 0.70000000000000018, 0.39999999999999991 },
  { 0.63429327633511257, 0.70000000000000018, 0.50000000000000000 },
  { 0.62991711532348671, 0.70000000000000018, 0.60000000000000009 },
  { 0.62473870640031781, 0.70000000000000018, 0.69999999999999996 },
  { 0.61875564895254531, 0.70000000000000018, 0.80000000000000004 },
  { 0.61196584557663802, 0.70000000000000018, 0.89999999999999991 },
  { 0.60436777711716361, 0.70000000000000018, 1.0000000000000000 },
};
const double toler017 = 0.050000000000000003;

// Test data for u=0.79999999999999982.
// max(|f - f_GSL|): 1.4557183986640991
// max(|f - f_GSL| / |f_GSL|): 2.1922255872621541
const testcase_jacobi_sn<double>
data018[21] =
{
  { 0.66403677026784891, 0.79999999999999982, -1.0000000000000000 },
  { 0.67430705718253059, 0.79999999999999982, -0.90000000000000002 },
  { 0.68344660798596601, 0.79999999999999982, -0.80000000000000004 },
  { 0.69146832464142693, 0.79999999999999982, -0.69999999999999996 },
  { 0.69838572137896415, 0.79999999999999982, -0.59999999999999998 },
  { 0.70421214154716705, 0.79999999999999982, -0.50000000000000000 },
  { 0.70896006689883062, 0.79999999999999982, -0.40000000000000002 },
  { 0.71264052596923799, 0.79999999999999982, -0.30000000000000004 },
  { 0.71526260604783820, 0.79999999999999982, -0.19999999999999996 },
  { 0.71683307160878840, 0.79999999999999982, -0.099999999999999978 },
  { 0.71735609089952268, 0.79999999999999982, 0.0000000000000000 },
  { 0.71683307160878840, 0.79999999999999982, 0.10000000000000009 },
  { 0.71526260604783820, 0.79999999999999982, 0.19999999999999996 },
  { 0.71264052596923799, 0.79999999999999982, 0.30000000000000004 },
  { 0.70896006689883073, 0.79999999999999982, 0.39999999999999991 },
  { 0.70421214154716705, 0.79999999999999982, 0.50000000000000000 },
  { 0.69838572137896415, 0.79999999999999982, 0.60000000000000009 },
  { 0.69146832464142693, 0.79999999999999982, 0.69999999999999996 },
  { 0.68344660798596601, 0.79999999999999982, 0.80000000000000004 },
  { 0.67430705718253059, 0.79999999999999982, 0.89999999999999991 },
  { 0.66403677026784891, 0.79999999999999982, 1.0000000000000000 },
};
const double toler018 = 0.050000000000000003;

// Test data for u=0.90000000000000036.
// max(|f - f_GSL|): 1.4939399985153716
// max(|f - f_GSL| / |f_GSL|): 2.0856407099190144
const testcase_jacobi_sn<double>
data019[21] =
{
  { 0.71629787019902458, 0.90000000000000036, -1.0000000000000000 },
  { 0.72942664566651516, 0.90000000000000036, -0.90000000000000002 },
  { 0.74103070284234995, 0.90000000000000036, -0.80000000000000004 },
  { 0.75114907234088191, 0.90000000000000036, -0.69999999999999996 },
  { 0.75982123800317514, 0.90000000000000036, -0.59999999999999998 },
  { 0.76708523758272773, 0.90000000000000036, -0.50000000000000000 },
  { 0.77297601414094097, 0.90000000000000036, -0.40000000000000002 },
  { 0.77752402664327158, 0.90000000000000036, -0.30000000000000004 },
  { 0.78075412134555011, 0.90000000000000036, -0.19999999999999996 },
  { 0.78268466132921033, 0.90000000000000036, -0.099999999999999978 },
  { 0.78332690962748364, 0.90000000000000036, 0.0000000000000000 },
  { 0.78268466132921033, 0.90000000000000036, 0.10000000000000009 },
  { 0.78075412134555011, 0.90000000000000036, 0.19999999999999996 },
  { 0.77752402664327158, 0.90000000000000036, 0.30000000000000004 },
  { 0.77297601414094119, 0.90000000000000036, 0.39999999999999991 },
  { 0.76708523758272773, 0.90000000000000036, 0.50000000000000000 },
  { 0.75982123800317514, 0.90000000000000036, 0.60000000000000009 },
  { 0.75114907234088191, 0.90000000000000036, 0.69999999999999996 },
  { 0.74103070284234995, 0.90000000000000036, 0.80000000000000004 },
  { 0.72942664566651527, 0.90000000000000036, 0.89999999999999991 },
  { 0.71629787019902458, 0.90000000000000036, 1.0000000000000000 },
};
const double toler019 = 0.050000000000000003;

// Test data for u=1.0000000000000000.
// max(|f - f_GSL|): 1.5231883119115297
// max(|f - f_GSL| / |f_GSL|): 2.0000000000000000
const testcase_jacobi_sn<double>
data020[21] =
{
  { 0.76159415595576485, 1.0000000000000000, -1.0000000000000000 },
  { 0.77764212831634771, 1.0000000000000000, -0.90000000000000002 },
  { 0.79168162839625034, 1.0000000000000000, -0.80000000000000004 },
  { 0.80380172005899353, 1.0000000000000000, -0.69999999999999996 },
  { 0.81409141238011851, 1.0000000000000000, -0.59999999999999998 },
  { 0.82263557812986232, 1.0000000000000000, -0.50000000000000000 },
  { 0.82951150451514089, 1.0000000000000000, -0.40000000000000002 },
  { 0.83478606565842461, 1.0000000000000000, -0.30000000000000004 },
  { 0.83851348688113936, 1.0000000000000000, -0.19999999999999996 },
  { 0.84073366201441269, 1.0000000000000000, -0.099999999999999978 },
  { 0.84147098480789650, 1.0000000000000000, 0.0000000000000000 },
  { 0.84073366201441269, 1.0000000000000000, 0.10000000000000009 },
  { 0.83851348688113936, 1.0000000000000000, 0.19999999999999996 },
  { 0.83478606565842461, 1.0000000000000000, 0.30000000000000004 },
  { 0.82951150451514100, 1.0000000000000000, 0.39999999999999991 },
  { 0.82263557812986232, 1.0000000000000000, 0.50000000000000000 },
  { 0.81409141238011828, 1.0000000000000000, 0.60000000000000009 },
  { 0.80380172005899353, 1.0000000000000000, 0.69999999999999996 },
  { 0.79168162839625034, 1.0000000000000000, 0.80000000000000004 },
  { 0.77764212831634771, 1.0000000000000000, 0.89999999999999991 },
  { 0.76159415595576485, 1.0000000000000000, 1.0000000000000000 },
};
const double toler020 = 0.050000000000000003;

template<typename Tp, unsigned int Num>
  void
  test(const testcase_jacobi_sn<Tp> (&data)[Num], Tp toler)
  {
    bool test __attribute__((unused)) = true;
    const Tp eps = std::numeric_limits<Tp>::epsilon();
    Tp max_abs_diff = -Tp(1);
    Tp max_abs_frac = -Tp(1);
    unsigned int num_datum = Num;
    for (unsigned int i = 0; i < num_datum; ++i)
      {
	const Tp f = __gnu_cxx::jacobi_sn(data[i].u, data[i].k);
	const Tp f0 = data[i].f0;
	const Tp diff = f - f0;
	if (std::abs(diff) > max_abs_diff)
	  max_abs_diff = std::abs(diff);
	if (std::abs(f0) > Tp(10) * eps
	 && std::abs(f) > Tp(10) * eps)
	  {
	    const Tp frac = diff / f0;
	    if (std::abs(frac) > max_abs_frac)
	      max_abs_frac = std::abs(frac);
	  }
      }
    VERIFY(max_abs_frac < toler);
  }

int
main()
{
  test(data001, toler001);
  test(data002, toler002);
  test(data003, toler003);
  test(data004, toler004);
  test(data005, toler005);
  test(data006, toler006);
  test(data007, toler007);
  test(data008, toler008);
  test(data009, toler009);
  test(data010, toler010);
  test(data011, toler011);
  test(data012, toler012);
  test(data013, toler013);
  test(data014, toler014);
  test(data015, toler015);
  test(data016, toler016);
  test(data017, toler017);
  test(data018, toler018);
  test(data019, toler019);
  test(data020, toler020);
  return 0;
}
